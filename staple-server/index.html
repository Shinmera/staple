<!DOCTYPE html> <html lang="EN"> <head> <meta charset="utf-8"> <title>Staple Server</title> <style>html body{margin:0 auto 0 auto;padding:20px;max-width:1024px;font-family:sans-serif;font-size:14pt;overflow-y:scroll;}html body a{text-decoration:none;}html body a[href]{color:#0055AA;}html body a[href]:hover{color:#0088EE;}html body pre{background:#FAFAFA;border:1px solid #DDDDDD;padding:0.75em;overflow-x:auto;}html body pre >code a[href]{color:#223388;}article.project h1,article.project h2,article.project h3,article.project h4,article.project h5,article.project h6{margin:0.2em 0 0.1em 0;text-indent:1em;}article.project >header{text-align:center;}article.project >header img.logo{display:block;margin:auto;max-height:170px;}article.project >header h1{display:inline-block;text-indent:0;font-size:2.5em;}article.project >header .version{vertical-align:bottom;}article.project >header .languages{margin-top:-0.5em;text-transform:capitalize;}article.project >header .description{margin:0;}article.project >header .pages{margin-top:0.5em;font-size:1.2em;text-transform:capitalize;}article.project >header .pages a{display:inline-block;padding:0 0.2em;}article.project >section{margin:1em 0 1em 0;}article.project #index >ul{list-style:none;margin:0;padding:0;}article.project .row label{display:inline-block;min-width:6em;}article.project #system .row{display:flex;}article.project #system #dependencies{display:inline;margin:0;padding:0;}article.project #system #dependencies li{display:inline;padding:0 0.2em;}article.definition{margin:1em 0 0 0;}article.definition >header h1,article.definition >header h2,article.definition >header h3,article.definition >header h4,article.definition >header h5,article.definition >header h6{text-indent:0;display:inline-block;}article.definition >header ul{display:inline-block;list-style:none;margin:0;padding:0;}article.definition >header ul li{display:inline-block;padding:0 0.2em 0 0;}article.definition >header .visibility{display:none;}article.definition >header .visibility,article.definition >header .type{text-transform:lowercase;}article.definition >header .source-link{visibility:hidden;float:right;}article.definition >header .source-link:after{visibility:visible;content:"[SRC]";}article.definition .docstring{margin:0 0 0 1em;}article.definition .docstring pre{font-size:0.8em;white-space:pre-wrap;}.definition.package >header ul.nicknames{display:inline-block;list-style:none;margin:0;padding:0 0 0 1em;}.definition.package >header ul.nicknames li{display:inline;}.definition.package >header ul.nicknames:before{content:"(";}.definition.package >header ul.nicknames:after{content:")";}.definition.package ul.definitions{margin:0;list-style:none;padding:0 0 0 0.5em;}.definition.callable >header .name:before,.definition.type >header .name:before{content:"(";font-weight:normal;}.definition.callable >header .arguments:after,.definition.type >header .arguments:after{content:")";}.definition.callable >header .arguments .arguments:before,.definition.type >header .arguments .arguments:before{content:"(";}.definition.callable >header .arguments .argument,.definition.type >header .arguments .argument{padding:0;}.definition.callable >header .arguments .argument.lambda-list-keyword,.definition.type >header .arguments .argument.lambda-list-keyword{color:#991155;}.definition li>mark{background:none;border-left:0.3em solid #0088EE;padding-left:0.3em;display:block;}</style> </head> <body> <article class="project"> <header>  <img class="logo" src="logo.svg" alt="Logo">  <h1>staple server</h1>  <span class="version">2.0.0</span>  <nav class="languages">                        <a href="index.html">English</a>              </nav>  <p class="description">An interactive documentation viewer using Staple</p>  <nav class="pages">  <a href="../logo.svg"/>    <a href="../logo.svg"/>    <a href="../index.html">staple</a>    <a href="../staple-package-recording/logo.svg"/>    <a href="../staple-package-recording/logo.svg"/>    <a href="../staple-package-recording/index.html">staple package recording</a>    <a href="../staple-code-parser/logo.svg"/>    <a href="../staple-code-parser/logo.svg"/>    <a href="../staple-code-parser/index.html">staple code parser</a>    <a href="logo.svg"/>    <a href="logo.svg"/>    <a href="index.html">staple server</a>    <a href="../staple-markdown/logo.svg"/>    <a href="../staple-markdown/logo.svg"/>    <a href="../staple-markdown/index.html">staple markdown</a>    <a href="../staple-markless/logo.svg"/>    <a href="../staple-markless/logo.svg"/>    <a href="../staple-markless/index.html">staple markless</a>  </nav> </header> <section id="documentation"><h2 id="about_staple-server">About Staple-Server</h2> <p>This is a live browser variant of Staple, giving you an immediate way of viewing documentation for all currently loaded systems.</p> <h2 id="how_to">How To</h2> <p>Load <code>staple-server</code> and start it up:</p> <pre><code>(<a href="#FUNCTION%20STAPLE-SERVER%3ASTART" class="xref">staple-server:start</a>)
</code></pre> <p>It should print the address of the server to your REPL. Simply paste it into your browser and you should be greeted with a systems index. The documentation for each system is generated on demand, so the first time you click on a system, it might take a bit to load it.</p> <p>When you're done and want to stop the server, you can simply run</p> <pre><code>(<a href="#FUNCTION%20STAPLE-SERVER%3ASTOP" class="xref">staple-server:stop</a>)
</code></pre> <p>The server keeps a cache of generated documentation in the system's temporary directory, so the cache will be automatically deleted once you reboot. If you would like to delete the cache immediately, you can run <code><a href="#FUNCTION%20STAPLE-SERVER%3ACLEAR-CACHE" class="xref">clear-cache</a></code>.</p> <h2 id="assumptions_about_generated_documentation">Assumptions About Generated Documentation</h2> <p>The server makes some assumptions about how the documentation of a system is generated. If the system does not customise staple, this is no problem. However, for systems that might customise it a lot, these assumptions might matter. The assumptions are as follows:</p> <ul> <li>The documentation output is HTML files.</li> <li>The links within the HTML are either relative or <code>file://</code> URLs.</li> <li>All files generated by the documentation are within the <code>:output-directory</code>.</li> <li>There is an <code>index.html</code> file directly within the <code>:output-directory</code> that shows the entry page for the system's documentation.</li> </ul> </section>   <section id="system"> <h2>System Information</h2>  <div class="row"> <label for="version">Version:</label> <a id="version">2.0.0</a> </div>   <div class="row"> <label for="dependencies">Dependencies:</label> <ul id="dependencies"><li><a class="external" href="https://Shinmera.github.io/staple/">staple-markdown</a></li><li><a class="external" href="https://Shinmera.github.io/staple/">staple-markless</a></li><li><a class="external">hunchentoot</a></li><li><a class="external" href="https://Shinmera.github.io/documentation-utils/">documentation-utils</a></li><li><a class="external" href="https://Shinmera.github.io/dissect/">dissect</a></li></ul> </div>   <div class="row"> <label for="author">Author:</label> <a id="author" href="mailto:shinmera@tymoon.eu">Nicolas Hafner</a> </div>   <div class="row"> <label for="license">License:</label> <a id="license" href="https://tldrlegal.com/search?q=Artistic">Artistic</a> </div>   <div class="row"> <label for="homepage">Homepage:</label> <a id="homepage" href="https://Shinmera.github.io/staple/">https://Shinmera.github.io/staple/</a> </div>  </section>   <section id="index"> <h2>Definition Index</h2> <ul> <li> <article class="definition package" id="PACKAGE STAPLE-SERVER"> <header> <h3> <a href="#PACKAGE%20STAPLE-SERVER">STAPLE-SERVER</a> </h3> <ul class="nicknames"> <li>ORG.SHIRAKUMO.STAPLE.SERVER</li> </ul>  </header> <div class="docstring"><i>No documentation provided.</i></div> <ul class="definitions"> <li> <article class="definition special-variable" id="VARIABLE STAPLE-SERVER:*TMPDIR*"> <header> <span class="visibility">EXTERNAL</span> <span class="type">SPECIAL-VARIABLE</span> <h4 class="name"> <a href="#VARIABLE%20STAPLE-SERVER%3A%2ATMPDIR%2A">*TMPDIR*</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments"></ul>  <a class="source-link" href="https://github.com/Shinmera/staple/blob/master/server.lisp#L11">Source</a>  </header> <div class="docstring"><pre>Pathname to the temporary file directory the server uses to store documentation output.

By default a subdirectory called &quot;staple-server&quot; in 
UIOP:TEMPORARY-DIRECTORY.

See <a href="#FUNCTION%20STAPLE-SERVER%3ASYSTEM-PATH" class="xref">SYSTEM-PATH</a></pre></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION STAPLE-SERVER:CACHE-SYSTEM"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20STAPLE-SERVER%3ACACHE-SYSTEM">CACHE-SYSTEM</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">SYSTEM</li>    <li class="argument lambda-list-keyword">&amp;OPTIONAL</li>    <li class="argument">DIR</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/staple/blob/master/server.lisp#L46">Source</a>  </header> <div class="docstring"><pre>Creates the cache for the given system.

Unless otherwise specified, the output is placed in the directory
returned by SYSTEM-PATH. The system is generated normally otherwise,
but supplying :if-exists :supersede. After generation, each HTML file
in the output directory is modified such that links to file:// urls
are replaced by ones that the server can handle, and each page gets
the nav.ctml contents injected at the bottom of its body.

This should ensure that the documentation can be customised heavily
by the owner of the projects, but still work within a server setting.

See <a href="#FUNCTION%20STAPLE-SERVER%3ASYSTEM-PATH" class="xref">SYSTEM-PATH</a>
See <a href="../index.html#GENERIC-FUNCTION%20STAPLE%3AGENERATE" class="xref">STAPLE:GENERATE</a></pre></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION STAPLE-SERVER:CLEAR-CACHE"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20STAPLE-SERVER%3ACLEAR-CACHE">CLEAR-CACHE</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument lambda-list-keyword">&amp;OPTIONAL</li>    <li class="argument">SYSTEM</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/staple/blob/master/server.lisp#L71">Source</a>  </header> <div class="docstring"><pre>Clears the cache by deleting all files in *TMPDIR*

See <a href="#VARIABLE%20STAPLE-SERVER%3A%2ATMPDIR%2A" class="xref">*TMPDIR*</a></pre></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION STAPLE-SERVER:START"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20STAPLE-SERVER%3ASTART">START</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument lambda-list-keyword">&amp;KEY</li>    <li class="argument">PORT</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/staple/blob/master/server.lisp#L108">Source</a>  </header> <div class="docstring"><pre>Starts the Staple server.

If *ACCEPTOR* is already set, an error is signalled. Otherwise, a new
ACCEPTOR instance is created and started.

See <a href="#VARIABLE%20STAPLE-SERVER%3A%2AACCEPTOR%2A" class="xref">*ACCEPTOR*</a>
See <a href="#CLASS%20STAPLE-SERVER%3AACCEPTOR" class="xref">ACCEPTOR</a></pre></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION STAPLE-SERVER:STOP"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20STAPLE-SERVER%3ASTOP">STOP</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments"></ul>  <a class="source-link" href="https://github.com/Shinmera/staple/blob/master/server.lisp#L117">Source</a>  </header> <div class="docstring"><pre>Stops the Staple server.

If *ACCEPTOR* is not set, an error is signalled. Otherwise the server
is stopped and unbound.

See <a href="#VARIABLE%20STAPLE-SERVER%3A%2AACCEPTOR%2A" class="xref">*ACCEPTOR*</a></pre></div> </article> </li> </ul> </article> </li> </ul> </section> </article> <script>window.addEventListener("DOMContentLoaded", function(){
    var unmarkElement = function(el){
        if(el.tagName === "mark" || el.tagName === "MARK"){
            [].forEach.call(el.childNodes, function(child){
                el.parentNode.insertBefore(child, el);
            });
            el.parentNode.removeChild(el);
        }else if(el.parentNode.tagName === "mark"){
            return unmarkElement(el.parentNode);
        }
        return null;
    }

    var unmarkAll = function(root){
        root = root || document;
        [].forEach.call(root.querySelectorAll("mark"), unmarkElement);
    }
    
    var markElement = function(el){
        if(el.parentNode.tagName === "mark" || el.parentNode.tagName === "MARK"){
            return el.parentNode;
        } else {
            unmarkAll();
            var marked = document.createElement("mark");
            el.parentNode.insertBefore(marked, el);
            marked.appendChild(el);
            return marked;
        }
    }

    var markFragmented = function(){
        if(window.location.hash){
            var el = document.getElementById(decodeURIComponent(window.location.hash.substr(1)));
            if(el) markElement(el);
        }
    }

    var registerXrefLink = function(link){
        var el = document.getElementById(decodeURIComponent(link.getAttribute("href").substr(1)));
        if(el){
            link.addEventListener("click", function(){
                markElement(el);
            });
        }
    }

    var registerXrefLinks = function(root){
        root = root || document;
        [].forEach.call(root.querySelectorAll("a.xref"), registerXrefLink);
    }

    markFragmented();
    registerXrefLinks();
}); </script> </body> </html> 