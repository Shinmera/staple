<!DOCTYPE html> <html lang="EN"> <head> <meta charset="utf-8"> <title>Staple</title> <style>html body{margin:0 auto 0 auto;padding:20px;max-width:1024px;font-family:sans-serif;font-size:14pt;overflow-y:scroll;}html body a{text-decoration:none;}html body a[href]{color:#0055AA;}html body a[href]:hover{color:#0088EE;}html body pre{background:#FAFAFA;border:1px solid #DDDDDD;padding:0.75em;overflow-x:auto;}html body pre >code a[href]{color:#223388;}article.project h1,article.project h2,article.project h3,article.project h4,article.project h5,article.project h6{margin:0.2em 0 0.1em 0;text-indent:1em;}article.project >header{text-align:center;}article.project >header img.logo{display:block;margin:auto;max-height:170px;}article.project >header h1{display:inline-block;text-indent:0;font-size:2.5em;}article.project >header .version{vertical-align:bottom;}article.project >header .languages{margin-top:-0.5em;text-transform:capitalize;}article.project >header .description{margin:0;}article.project >header .pages{margin-top:0.5em;font-size:1.2em;text-transform:capitalize;}article.project >header .pages a{display:inline-block;padding:0 0.2em;}article.project >section{margin:1em 0 1em 0;}article.project #index >ul{list-style:none;margin:0;padding:0;}article.project .row label{display:inline-block;min-width:6em;}article.project #system .row{display:flex;}article.project #system #dependencies{display:inline;margin:0;padding:0;}article.project #system #dependencies li{display:inline;padding:0 0.2em;}article.definition{margin:1em 0 0 0;}article.definition >header h1,article.definition >header h2,article.definition >header h3,article.definition >header h4,article.definition >header h5,article.definition >header h6{text-indent:0;display:inline-block;}article.definition >header ul{display:inline-block;list-style:none;margin:0;padding:0;}article.definition >header ul li{display:inline-block;padding:0 0.2em 0 0;}article.definition >header .visibility{display:none;}article.definition >header .visibility,article.definition >header .type{text-transform:lowercase;}article.definition >header .source-link{visibility:hidden;float:right;}article.definition >header .source-link:after{visibility:visible;content:"[SRC]";}article.definition .docstring{margin:0 0 0 1em;}article.definition .docstring pre{font-size:0.8em;white-space:pre-wrap;}.definition.package >header ul.nicknames{display:inline-block;list-style:none;margin:0;padding:0 0 0 1em;}.definition.package >header ul.nicknames li{display:inline;}.definition.package >header ul.nicknames:before{content:"(";}.definition.package >header ul.nicknames:after{content:")";}.definition.package ul.definitions{margin:0;list-style:none;padding:0 0 0 0.5em;}.definition.callable >header .name:before,.definition.type >header .name:before{content:"(";font-weight:normal;}.definition.callable >header .arguments:after,.definition.type >header .arguments:after{content:")";}.definition.callable >header .arguments .arguments:before,.definition.type >header .arguments .arguments:before{content:"(";}.definition.callable >header .arguments .argument,.definition.type >header .arguments .argument{padding:0;}.definition.callable >header .arguments .argument.lambda-list-keyword,.definition.type >header .arguments .argument.lambda-list-keyword{color:#991155;}.definition li>mark{background:none;border-left:0.3em solid #0088EE;padding-left:0.3em;display:block;}</style> </head> <body> <article class="project"> <header>  <img class="logo" src="logo.svg" alt="Logo">  <h1>staple</h1>  <span class="version">2.0.0</span>  <nav class="languages">      <a href="index.html">English</a>                                </nav>  <p class="description">A tool to generate documentation about Lisp projects through an HTML template.</p>  <nav class="pages">  <a href="logo.svg"/>    <a href="logo.svg"/>    <a href="index.html">staple</a>    <a href="staple-package-recording/logo.svg"/>    <a href="staple-package-recording/logo.svg"/>    <a href="staple-package-recording/index.html">staple package recording</a>    <a href="staple-code-parser/logo.svg"/>    <a href="staple-code-parser/logo.svg"/>    <a href="staple-code-parser/index.html">staple code parser</a>    <a href="staple-server/logo.svg"/>    <a href="staple-server/logo.svg"/>    <a href="staple-server/index.html">staple server</a>    <a href="staple-markdown/logo.svg"/>    <a href="staple-markdown/logo.svg"/>    <a href="staple-markdown/index.html">staple markdown</a>    <a href="staple-markless/logo.svg"/>    <a href="staple-markless/logo.svg"/>    <a href="staple-markless/index.html">staple markless</a>  </nav> </header> <section id="documentation"><h2 id="about_staple">About Staple</h2> <p>Staple is a documentation system. It provides you with a way to generate standalone documentation accumulated from various sources such as readmes, documentation files, and docstrings.</p> <h2 id="how_to">How To</h2> <p>The most trivial manner in which to use staple is to simply run it and let its inference mechanism figure out how to document your system. You can do that like so:</p> <pre><code>(<a href="#GENERIC-FUNCTION%20STAPLE%3AGENERATE" class="xref">staple:generate</a> :my-system)
</code></pre> <p>For best immediate results you should <em>not</em> load your system before you load Staple, so that Staple can record the packages the system defines as it is being loaded. If you later customise the documentation and set the packages explicitly, you don't have to watch out for that anymore, though. The documentation should land in a subdirectory called <code>doc</code> within the system's source directory. For ad-hoc usage you can change some of the behaviour through keyword arguments:</p> <ul> <li><code>:output-directory</code> The base directory in which documentation files are stored.</li> <li><code>:images</code> A list of paths to image files that might be used in the documentation. The first image is used as the project's logo.</li> <li><code>:documents</code> A list of documents for which to generate documentation pages. This usually refers to things like <code>README.md</code> and such. Typically you would only have multiple of these if you have translated the documentation into different languages. In that case, Staple will create an index page for each language individually.</li> <li><code>:page-type</code> The class to use for pages. See the sections below.</li> <li><code>:template</code> The template file to use. If you want to customise what the documentation pages look like, you might want to change this to one of your own.</li> <li><code>:if-exists</code> What to do if the output file already exists.</li> <li><code>:compact</code> Whether to compact the HTML files by trimming extraneous whitespace. Activated by default.</li> <li><code>:packages</code> The packages that should be included in the definitions index.</li> <li><code>:subsystems</code> A list of subsystems that are related to this primary system and should be included in the generation.</li> </ul> <p>However, if you change any of these options, you will likely want to persist them somehow. The best way to do this is to use Staple's customisation mechanism. See the sections below for that.</p> <p>You may also be interested in <a href="staple-server/">Staple's server system</a>, which gives you a live documentation browser for all systems currently loaded in your Lisp image.</p> <h2 id="concepts">Concepts</h2> <p>Staple organises itself around <code><a href="#GENERIC-FUNCTION%20STAPLE%3APROJECT" class="xref">project</a></code>s and <code><a href="#CLASS%20STAPLE%3APAGE" class="xref">page</a></code>s. Every mechanism in it is an extension of those two concepts.</p> <h3 id="projects">Projects</h3> <p>Projects represent a, well, project. This is distinct from an ASDF system, as a project might encompass multiple systems. Similarly, an ASDF system fed to <code><a href="#GENERIC-FUNCTION%20STAPLE%3AGENERATE" class="xref">generate</a></code> might generate documentation for multiple ASDF systems at once. While a project might represent multiple systems, it is always identified by at least one &quot;primary&quot; system.</p> <p>In order to get the project for a primary system, you can use <code><a href="#GENERIC-FUNCTION%20STAPLE%3AFIND-PROJECT" class="xref">find-project</a></code>. This will return NIL if no specific project is defined for a system. In that case you may also use <code><a href="#GENERIC-FUNCTION%20STAPLE%3AINFER-PROJECT" class="xref">infer-project</a></code> to let Staple try and figure out a project for the system automatically.</p> <p>Each project is composed of a number of pages. When a project is <code><a href="#GENERIC-FUNCTION%20STAPLE%3AGENERATE" class="xref">generate</a></code>d, each of its <code><a href="#GENERIC-FUNCTION%20STAPLE%3APAGES" class="xref">pages</a></code> are generated as well, producing the actual output of the project.</p> <h3 id="pages">Pages</h3> <p>A page represents an output that should be generated as part of a project. Typically this will be some kind of file, like an HTML document. A page has a specific <code><a href="#GENERIC-FUNCTION%20STAPLE%3ALANGUAGE" class="xref">language</a></code> and a <code><a href="#GENERIC-FUNCTION%20STAPLE%3ATITLE" class="xref">title</a></code>. Pages with the same title should represent the same page, but in different languages. This allows you to write multilingual documentation. More on that later.</p> <p>All you can do with a page, aside from inspecting its language, title, and <code><a href="#GENERIC-FUNCTION%20STAPLE%3AOUTPUT" class="xref">output</a></code>, is to <code><a href="#GENERIC-FUNCTION%20STAPLE%3AGENERATE" class="xref">generate</a></code> it. For anything more advanced, you should have a look at its subclasses:</p> <h4 id="input-page"><code><a href="#CLASS%20STAPLE%3AINPUT-PAGE" class="xref">input-page</a></code></h4> <p>This is a primitive subclass of the page that denotes some kind of <code><a href="#GENERIC-FUNCTION%20STAPLE%3AINPUT" class="xref">input</a></code> that is being transformed when the page is generated. It should be used for anything that bases its output on some kind of input file or stream.</p> <h4 id="static-page"><code><a href="#CLASS%20STAPLE%3ASTATIC-PAGE" class="xref">static-page</a></code></h4> <p>This page simply copies the input to the output verbatim, providing a way to define static files such as images and so forth. Since images and such resources are not really &quot;pages&quot; per se, this might be a strange fit, but by simply leaving the title <code>NIL</code>, you can use the same mechanisms regardless.</p> <h4 id="compiled-page"><code><a href="#CLASS%20STAPLE%3ACOMPILED-PAGE" class="xref">compiled-page</a></code></h4> <p>Compiled pages use Staple's <code><a href="#GENERIC-FUNCTION%20STAPLE%3ACOMPILE-SOURCE" class="xref">compile-source</a></code> mechanism, which translates source in some other format like Markdown into HTML. By default only text and HTML itself is supported, but you can trivially add other formats, or use the <code>staple-markdown</code> system to add Markdown support automatically.</p> <h4 id="templated-page"><code><a href="#CLASS%20STAPLE%3ATEMPLATED-PAGE" class="xref">templated-page</a></code></h4> <p>This kind of page uses the Clip system to perform a template expansion. If you want to use this kind of page, you should subclass it and add a method on <code><a href="#GENERIC-FUNCTION%20STAPLE%3ATEMPLATE-DATA" class="xref">template-data</a></code> to supply the necessary data to the Clip template. See <a href="https://shinmera.github.io/clip">Clip</a> for further information.</p> <h4 id="definitions-index-page"><code><a href="#CLASS%20STAPLE%3ADEFINITIONS-INDEX-PAGE" class="xref">definitions-index-page</a></code></h4> <p>Often times you'll want to include a definitions index alongside the main documentation content. THis page adds additional support for this by including a list of <code><a href="#GENERIC-FUNCTION%20STAPLE%3APACKAGES" class="xref">packages</a></code> to define, and several methods to aid in formatting the definitions, such as <code><a href="#GENERIC-FUNCTION%20STAPLE%3AFORMAT-DOCUMENTATION" class="xref">format-documentation</a></code>, <code><a href="#GENERIC-FUNCTION%20STAPLE%3ARESOLVE-SOURCE-LINK" class="xref">resolve-source-link</a></code>, <code><a href="#GENERIC-FUNCTION%20STAPLE%3ADEFINITION-WANTED-P" class="xref">definition-wanted-p</a></code>, and <code><a href="#GENERIC-FUNCTION%20STAPLE%3ADEFINITIONS" class="xref">definitions</a></code>. Note that this is a subclass of <code><a href="#CLASS%20STAPLE%3ATEMPLATED-PAGE" class="xref">templated-page</a></code>, meaning that if you want a definitions index, but don't want to use Clip, you'll need to do some work of your own.</p> <h4 id="system-page"><code><a href="#CLASS%20STAPLE%3ASYSTEM-PAGE" class="xref">system-page</a></code></h4> <p>This page adds some additional convenience when dealing with pages that document a specific ASDF system.</p> <h4 id="simple-page"><code><a href="#CLASS%20STAPLE%3ASIMPLE-PAGE" class="xref">simple-page</a></code></h4> <p>Finally, the simple page is used for inferred projects and offers a base page for easy customisation. It provides sensible defaults for definition inclusion, template data, and so forth.</p> <h2 id="customisation">Customisation</h2> <p>Customising Staple should happen through a file called <code>staple.ext.lisp</code> within your primary system's root source directory. This file is automatically loaded by Staple when the system is generated, making it convenient to add extra functionality.</p> <p>There's two ways in which to customise how Staple generates the documentation for your system. You can either define your own project manually for maximum control, or influence the inference mechanism for some quick and easy changes.</p> <h3 id="custom_projects">Custom Projects</h3> <p>Customising projects is easy to explain, as it simply involves adding a method to <code><a href="#GENERIC-FUNCTION%20STAPLE%3AFIND-PROJECT" class="xref">find-project</a></code> specialising on your system's name that returns the readily made project instance.</p> <pre><code>(<a href="http://l1sp.org/cl/defmethod" class="xref">defmethod</a> <a href="#GENERIC-FUNCTION%20STAPLE%3AFIND-PROJECT" class="xref">staple:find-project</a> ((system (<a href="http://l1sp.org/cl/eql" class="xref">eql</a> (asdf:find-system :my-system))) &amp;key)
  #|.. create project ..|#)
</code></pre> <p>See the documentation for the different kinds of pages to see what you can do with them. One thing you should always respect is the <code>:output-directory</code> keyword argument, which should provide the root directory in which the documentation is stored. You can find a good default using the <code><a href="#GENERIC-FUNCTION%20STAPLE%3AOUTPUT-DIRECTORY" class="xref">output-directory</a></code> function on your system.</p> <p>You should still read the following sections, as they will show examples on how to customise pages and what kinds of functions there are to influence behaviour so that you don't necessarily need to write everything from scratch unless you want to.</p> <h3 id="custom_inference">Custom Inference</h3> <p>As mentioned in the How To section above, you can persist the different options you can pass to generate by changing the project inference. The following functions are called to determine the default values for the respective keyword arguments:</p> <ul> <li><code><a href="#GENERIC-FUNCTION%20STAPLE%3AOUTPUT-DIRECTORY" class="xref">output-directory</a></code></li> <li><code><a href="#GENERIC-FUNCTION%20STAPLE%3ADOCUMENTS" class="xref">documents</a></code></li> <li><code><a href="#GENERIC-FUNCTION%20STAPLE%3AIMAGES" class="xref">images</a></code></li> <li><code><a href="#GENERIC-FUNCTION%20STAPLE%3APAGE-TYPE" class="xref">page-type</a></code></li> <li><code><a href="#GENERIC-FUNCTION%20STAPLE%3ATEMPLATE" class="xref">template</a></code></li> <li><code><a href="#GENERIC-FUNCTION%20STAPLE%3APACKAGES" class="xref">packages</a></code></li> <li><code><a href="#GENERIC-FUNCTION%20STAPLE%3ASUBSYSTEMS" class="xref">subsystems</a></code></li> </ul> <p>In order to override these, just write a method specialising on your system:</p> <pre><code>(<a href="http://l1sp.org/cl/defmethod" class="xref">defmethod</a> <a href="#GENERIC-FUNCTION%20STAPLE%3ATEMPLATE" class="xref">staple:template</a> ((system (<a href="http://l1sp.org/cl/eql" class="xref">eql</a> (asdf:find-system :my-system))))
  (asdf:system-relative-pathname system #p&quot;my-template.ctml&quot;))
</code></pre> <p>Some properties like the way documentation and docstrings are formatted require changing the way pages behave. For that, you can override the <code><a href="#GENERIC-FUNCTION%20STAPLE%3APAGE-TYPE" class="xref">page-type</a></code> similar to the above code snippet, and implement a custom page subclass as illustrated in the next section.</p> <h3 id="custom_pages">Custom Pages</h3> <p>By subclassing <code><a href="#CLASS%20STAPLE%3ASIMPLE-PAGE" class="xref">simple-page</a></code>, you can customise all sorts of behaviours.</p> <pre><code>(<a href="http://l1sp.org/cl/defclass" class="xref">defclass</a> my-page (staple:simple-page) ())
</code></pre> <p>Following are a few examples for things one might frequently want to change about the default behaviour of a page. If you are customising project inference, you can use <code><a href="#GENERIC-FUNCTION%20STAPLE%3APAGE-TYPE" class="xref">page-type</a></code> to use this page:</p> <pre><code>(<a href="http://l1sp.org/cl/defmethod" class="xref">defmethod</a> <a href="#GENERIC-FUNCTION%20STAPLE%3APAGE-TYPE" class="xref">staple:page-type</a> ((system (<a href="http://l1sp.org/cl/eql" class="xref">eql</a> (asdf:find-system :my-system))))
  'my-page)
</code></pre> <h4 id="changing_which_definitions_are_shown">Changing Which Definitions are Shown</h4> <pre><code>(<a href="http://l1sp.org/cl/defmethod" class="xref">defmethod</a> <a href="#GENERIC-FUNCTION%20STAPLE%3ADEFINITION-WANTED-P" class="xref">staple:definition-wanted-p</a> ((_ <a href="https://Shinmera.github.io/definitions/#CLASS%20DEFINITIONS%3AMETHOD" class="xref">definitions:method</a>) (__ my-page)) T)
(<a href="http://l1sp.org/cl/defmethod" class="xref">defmethod</a> <a href="#GENERIC-FUNCTION%20STAPLE%3ADEFINITION-WANTED-P" class="xref">staple:definition-wanted-p</a> ((_ <a href="https://Shinmera.github.io/definitions/#CLASS%20DEFINITIONS%3ACOMPILER-MACRO" class="xref">definitions:compiler-macro</a>) (__ my-page)) T)
(<a href="http://l1sp.org/cl/defmethod" class="xref">defmethod</a> <a href="#GENERIC-FUNCTION%20STAPLE%3ADEFINITION-WANTED-P" class="xref">staple:definition-wanted-p</a> ((_ <a href="https://Shinmera.github.io/definitions/#CLASS%20DEFINITIONS%3AMACRO" class="xref">definitions:macro</a>) (__ my-page)) NIL)
</code></pre> <p>This will show methods and compiler-macros, but hide macros. By default all definitions for external symbols are shown except for methods, packages, compiler-macros, and declarations.</p> <h4 id="including_additional_definitions">Including Additional Definitions</h4> <pre><code>(<a href="http://l1sp.org/cl/defmethod" class="xref">defmethod</a> <a href="#GENERIC-FUNCTION%20STAPLE%3ADEFINITIONS" class="xref">staple:definitions</a> ((page my-page) package)
  (<a href="http://l1sp.org/cl/append" class="xref">append</a> (<a href="https://Shinmera.github.io/definitions/#GENERIC-FUNCTION%20DEFINITIONS%3AFIND-DEFINITIONS" class="xref">definitions:find-definitions</a> 'cl:if)
          (call-next-method)))
</code></pre> <p>This forces the definitions for <code><a href="http://l1sp.org/cl/if" class="xref">cl:if</a></code> to be included with the rest of the definitions for the packages of the page.</p> <h4 id="changing_source_links">Changing Source Links</h4> <pre><code>(<a href="http://l1sp.org/cl/defmethod" class="xref">defmethod</a> <a href="#GENERIC-FUNCTION%20STAPLE%3ARESOLVE-SOURCE-LINK" class="xref">staple:resolve-source-link</a> (source (page my-page))
  (<a href="http://l1sp.org/cl/format" class="xref">format</a> NIL &quot;http://someplace/view-file/~a#line-~a&quot; 
    (make-path-relative-somehow (<a href="http://l1sp.org/cl/getf" class="xref">getf</a> source :file))
    (<a href="http://l1sp.org/cl/getf" class="xref">getf</a> source :row)))
</code></pre> <p>Note that by default, if you set the <code>:homepage</code> property in your ASDF system definition to a GitHub project URL, it will try to automatically compute the URL to GitHub's file viewer.</p> <h4 id="changing_docstring_formatting">Changing Docstring Formatting</h4> <pre><code>(<a href="http://l1sp.org/cl/defmethod" class="xref">defmethod</a> <a href="#GENERIC-FUNCTION%20STAPLE%3AFORMAT-DOCUMENTATION" class="xref">staple:format-documentation</a> ((docstring <a href="http://l1sp.org/cl/string" class="xref">string</a>) (page my-page))
  (let ((<a href="http://l1sp.org/cl/%2Apackage%2A" class="xref">*package*</a> (<a href="http://l1sp.org/cl/first" class="xref">first</a> (<a href="staple-package-recording/index.html#GENERIC-FUNCTION%20STAPLE-PACKAGE-RECORDING%3APACKAGES" class="xref">staple:packages</a> page))))
    (<a href="#FUNCTION%20STAPLE%3AMARKUP-CODE-SNIPPETS-IGNORING-ERRORS" class="xref">staple:markup-code-snippets-ignoring-errors</a>
     (<a href="#GENERIC-FUNCTION%20STAPLE%3ACOMPILE-SOURCE" class="xref">staple:compile-source</a> docstring :markdown))))
</code></pre> <p>This will parse the docstring as Markdown and cross-reference all code snippets. Make sure to also load the <code>staple-markdown</code> system in your extension file.</p> <h4 id="changing_document_formatting">Changing Document Formatting</h4> <pre><code>(<a href="http://l1sp.org/cl/defmethod" class="xref">defmethod</a> <a href="#GENERIC-FUNCTION%20STAPLE%3ACOMPILE-SOURCE" class="xref">staple:compile-source</a> ((document <a href="http://l1sp.org/cl/pathname" class="xref">pathname</a>) (page my-page))
  (<a href="#GENERIC-FUNCTION%20STAPLE%3ACOMPILE-SOURCE" class="xref">staple:compile-source</a> document :text))
</code></pre> <p>This will force the document to be parsed as raw text.</p> <h4 id="changing_the_filename">Changing the Filename</h4> <pre><code>(<a href="http://l1sp.org/cl/defmethod" class="xref">defmethod</a> <a href="#GENERIC-FUNCTION%20STAPLE%3AFILENAME" class="xref">staple:filename</a> ((page my-page))
  (<a href="http://l1sp.org/cl/make-pathname" class="xref">make-pathname</a> :name &quot;foo&quot; :type &quot;html&quot;))
</code></pre> <p>This will force the file name of all pages to be <code>foo.html</code>.</p> <h4 id="changing_or_adding_template_data">Changing or Adding Template Data</h4> <pre><code>(<a href="http://l1sp.org/cl/defmethod" class="xref">defmethod</a> <a href="#GENERIC-FUNCTION%20STAPLE%3ATEMPLATE-DATA" class="xref">staple:template-data</a> append ((page my-page))
  (<a href="http://l1sp.org/cl/list" class="xref">list</a> :title &quot;My Title&quot;
        :generation-time (<a href="http://l1sp.org/cl/get-universal-time" class="xref">get-universal-time</a>)))
</code></pre> <p>Due to the <code><a href="#FUNCTION%20STAPLE%3AAPPEND" class="xref">append</a></code> method-combination and the way <code><a href="#FUNCTION%20STAPLE%3AGETF" class="xref">getf</a></code> works, this will override the <code>:title</code> value, and add the new <code>:generation-time</code> value which can now be referenced from the template.</p> <h4 id="changing_generation_behaviour">Changing Generation Behaviour</h4> <pre><code>(<a href="http://l1sp.org/cl/defmethod" class="xref">defmethod</a> <a href="#GENERIC-FUNCTION%20STAPLE%3AGENERATE" class="xref">staple:generate</a> :after ((page my-page) &amp;key)
  (<a href="http://l1sp.org/cl/format" class="xref">format</a> <a href="http://l1sp.org/cl/%2Adebug-io%2A" class="xref">*debug-io*</a> &quot;~&amp; Generated ~a.~%&quot; page))
</code></pre> <p>This adds a method that is called once the generation has completed, and simply prints a status message saying as much. You can use all the usual tricks of the standard method combination to customise things to your heart's content.</p> <h3 id="custom_templates">Custom Templates</h3> <p>Writing a custom template is mostly a question of writing an HTML document that you want, and then filling in the necessary Clip attributes to add the data in the right spots. Figuring this out should be pretty trivial if you have a look at the existing <a href="https://github.com/Shinmera/staple/tree/master/default/default.ctml">default template</a> and the <a href="https://shinmera.github.io/clip">Clip documentation</a></p> <h2 id="fixing_github">Fixing GitHub</h2> <p>By default Staple outputs the documentation into the source tree of your project. This will cause GitHub to index the HTML file and, depending on circumstances, think that your project is now primarily an HTML project. To fix this issue, you should mark the documentation as ignored for GitHub's indexer. You can do this by putting the following into a <code>.gitattributes</code> file at the repository root:</p> <pre><code>doc/ linguist-vendored
</code></pre> <h2 id="an_example_customisation_file">An Example Customisation File</h2> <p>This is a simple example customisation file that changes the inferred project to use a custom markup syntax and package list.</p> <pre><code>(asdf:load-system :staple-markdown)

(<a href="http://l1sp.org/cl/defclass" class="xref">defclass</a> my-page (staple:simple-page) ())

(<a href="http://l1sp.org/cl/defmethod" class="xref">defmethod</a> <a href="#GENERIC-FUNCTION%20STAPLE%3APAGE-TYPE" class="xref">staple:page-type</a> ((system (<a href="http://l1sp.org/cl/eql" class="xref">eql</a> (asdf:find-system :my-system))))
  'my-page)

(<a href="http://l1sp.org/cl/defmethod" class="xref">defmethod</a> <a href="staple-package-recording/index.html#GENERIC-FUNCTION%20STAPLE-PACKAGE-RECORDING%3APACKAGES" class="xref">staple:packages</a> ((system (<a href="http://l1sp.org/cl/eql" class="xref">eql</a> (asdf:find-system :my-system))))
  (<a href="http://l1sp.org/cl/mapcar" class="xref">mapcar</a> <a href="http://l1sp.org/cl/find-package" class="xref">#'find-package</a> '(:my-system :my-system-other)))

(<a href="http://l1sp.org/cl/defmethod" class="xref">defmethod</a> <a href="#GENERIC-FUNCTION%20STAPLE%3AFORMAT-DOCUMENTATION" class="xref">staple:format-documentation</a> ((docstring <a href="http://l1sp.org/cl/string" class="xref">string</a>) (page my-page))
  (let ((<a href="http://l1sp.org/cl/%2Apackage%2A" class="xref">*package*</a> (<a href="http://l1sp.org/cl/first" class="xref">first</a> (<a href="staple-package-recording/index.html#GENERIC-FUNCTION%20STAPLE-PACKAGE-RECORDING%3APACKAGES" class="xref">staple:packages</a> page))))
    (<a href="#FUNCTION%20STAPLE%3AMARKUP-CODE-SNIPPETS-IGNORING-ERRORS" class="xref">staple:markup-code-snippets-ignoring-errors</a>
     (<a href="#GENERIC-FUNCTION%20STAPLE%3ACOMPILE-SOURCE" class="xref">staple:compile-source</a> docstring :markdown))))
</code></pre> <h2 id="custom_global_definitions">Custom Global Definitions</h2> <p>Staple has support for documenting arbitrary definition types aside from the standard top level definition types that Common Lisp exposes. This is done through the <a href="https://shinmera.github.io/definitions">Definitions</a> library. Please see its documentation on how to <a href="https://shinmera.github.io/definitions/#extending_definitions">add custom definitions</a>. You can write this extra glue code into your <code>staple.ext.lisp</code> file along with all the other Staple customisations. When a new definition type is defined, Staple will automatically try to find it and include it in your <code><a href="#CLASS%20STAPLE%3ASIMPLE-PAGE" class="xref">simple-page</a></code>s. If you would like to be more selective, see <code><a href="#GENERIC-FUNCTION%20STAPLE%3ADEFINITION-WANTED-P" class="xref">definition-wanted-p</a></code> above.</p> <p>Also of interest are <code><a href="#GENERIC-FUNCTION%20STAPLE%3ADEFINITION-ID" class="xref">definition-id</a></code>, <code><a href="#GENERIC-FUNCTION%20STAPLE%3ADEFINITION-ORDER" class="xref">definition-order</a></code>, and <code><a href="#GENERIC-FUNCTION%20STAPLE%3ADEFINITION-IMPORTANCE" class="xref">definition-importance</a></code>, which control the page anchors and order of appearance of definitions in an index.</p> </section>   <section id="system"> <h2>System Information</h2>  <div class="row"> <label for="version">Version:</label> <a id="version">2.0.0</a> </div>   <div class="row"> <label for="dependencies">Dependencies:</label> <ul id="dependencies"><li><a class="external" href="https://Shinmera.github.io/staple/">staple-package-recording</a></li><li><a class="external" href="https://Shinmera.github.io/staple/">staple-code-parser</a></li><li><a class="external">babel</a></li><li><a class="external" href="https://Shinmera.github.io/clip/">clip</a></li><li><a class="external">cl-ppcre</a></li><li><a class="external" href="https://Shinmera.github.io/definitions/">definitions</a></li><li><a class="external" href="https://Shinmera.github.io/pathname-utils/">pathname-utils</a></li><li><a class="external" href="https://github.com/Shinmera/language-codes">language-codes</a></li><li><a class="external" href="https://Shinmera.github.io/documentation-utils/">documentation-utils</a></li></ul> </div>   <div class="row"> <label for="author">Author:</label> <a id="author" href="mailto:shinmera@tymoon.eu">Nicolas Hafner</a> </div>   <div class="row"> <label for="license">License:</label> <a id="license" href="https://github.com/Shinmera/staple/blob/master/LICENSE">Artistic</a> </div>   <div class="row"> <label for="homepage">Homepage:</label> <a id="homepage" href="https://Shinmera.github.io/staple/">https://Shinmera.github.io/staple/</a> </div>  </section>   <section id="index"> <h2>Definition Index</h2> <ul> <li> <article class="definition package" id="PACKAGE STAPLE"> <header> <h3> <a href="#PACKAGE%20STAPLE">STAPLE</a> </h3> <ul class="nicknames"> <li>ORG.SHIRAKUMO.STAPLE</li> </ul>  </header> <div class="docstring"><i>No documentation provided.</i></div> <ul class="definitions"> <li> <article class="definition special-variable" id="VARIABLE STAPLE:*DEFAULT-TEMPLATE*"> <header> <span class="visibility">EXTERNAL</span> <span class="type">SPECIAL-VARIABLE</span> <h4 class="name"> <a href="#VARIABLE%20STAPLE%3A%2ADEFAULT-TEMPLATE%2A">*DEFAULT-TEMPLATE*</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments"></ul>  <a class="source-link" href="https://github.com/Shinmera/staple/blob/master/inference.lisp#L15">Source</a>  </header> <div class="docstring"><pre>Pathname to the default Clip template used for simple pages.

See <a href="#CLASS%20STAPLE%3ASIMPLE-PAGE" class="xref">SIMPLE-PAGE</a></pre></div> </article> </li>  <li> <article class="definition special-variable" id="VARIABLE STAPLE:*DOCUMENT-PATTERNS*"> <header> <span class="visibility">EXTERNAL</span> <span class="type">SPECIAL-VARIABLE</span> <h4 class="name"> <a href="#VARIABLE%20STAPLE%3A%2ADOCUMENT-PATTERNS%2A">*DOCUMENT-PATTERNS*</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments"></ul>  <a class="source-link" href="https://github.com/Shinmera/staple/blob/master/inference.lisp#L9">Source</a>  </header> <div class="docstring"><pre>A list of regular expression patterns that recognise document files.

An expression in this list should match the filename of a file that
denotes a documentation body file.</pre></div> </article> </li>  <li> <article class="definition special-variable" id="VARIABLE STAPLE:*IMAGE-PATTERNS*"> <header> <span class="visibility">EXTERNAL</span> <span class="type">SPECIAL-VARIABLE</span> <h4 class="name"> <a href="#VARIABLE%20STAPLE%3A%2AIMAGE-PATTERNS%2A">*IMAGE-PATTERNS*</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments"></ul>  <a class="source-link" href="https://github.com/Shinmera/staple/blob/master/inference.lisp#L12">Source</a>  </header> <div class="docstring"><pre>A list of regular expression patterns that recognise image files.

An expression in this list should match the filename of a file that
denotes an image file.</pre></div> </article> </li>  <li> <article class="definition special-variable" id="VARIABLE STAPLE:*LOAD-PROHIBITED-SYSTEMS*"> <header> <span class="visibility">EXTERNAL</span> <span class="type">SPECIAL-VARIABLE</span> <h4 class="name"> <a href="#VARIABLE%20STAPLE%3A%2ALOAD-PROHIBITED-SYSTEMS%2A">*LOAD-PROHIBITED-SYSTEMS*</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments"></ul>  <a class="source-link" href="https://github.com/Shinmera/staple/blob/master/project.lisp#L9">Source</a>  </header> <div class="docstring"><pre>A list of ASDF:SYSTEM instances that should not be loaded for extensions.

This is a curated list of special systems that cause problems when
being loaded as part of the LOAD-EXTENSION mechanism.

See <a href="#FUNCTION%20STAPLE%3ALOAD-EXTENSION" class="xref">LOAD-EXTENSION</a></pre></div> </article> </li>  <li> <article class="definition special-variable" id="VARIABLE STAPLE:*PAGE*"> <header> <span class="visibility">EXTERNAL</span> <span class="type">SPECIAL-VARIABLE</span> <h4 class="name"> <a href="#VARIABLE%20STAPLE%3A%2APAGE%2A">*PAGE*</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments"></ul>  <a class="source-link" href="https://github.com/Shinmera/staple/blob/master/page.lisp#L9">Source</a>  </header> <div class="docstring"><pre>Variable bound to the current page during generation.

See <a href="#CLASS%20STAPLE%3APAGE" class="xref">PAGE</a>
See <a href="#GENERIC-FUNCTION%20STAPLE%3AGENERATE" class="xref">GENERATE</a></pre></div> </article> </li>  <li> <article class="definition class" id="CLASS STAPLE:COMPILED-PAGE"> <header> <span class="visibility">EXTERNAL</span> <span class="type">CLASS</span> <h4 class="name"> <a href="#CLASS%20STAPLE%3ACOMPILED-PAGE">COMPILED-PAGE</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments"></ul>  <a class="source-link" href="https://github.com/Shinmera/staple/blob/master/page.lisp#L79">Source</a>  </header> <div class="docstring"><pre>A compiled page that is created by translating some input file.

In order to handle the translation, COMPILE-SOURCE is used.
The output of COMPILE-SOURCE may be a PLUMP:NODE, a STRING, or an
(unsigned-byte 8) vector. In the case of a PLUMP:NODE, the node is
first compressed using COMPACT if the :COMPACT argument to GENERATE
is non-NIL (default).

See <a href="#CLASS%20STAPLE%3AINPUT-PAGE" class="xref">INPUT-PAGE</a>
See <a href="#GENERIC-FUNCTION%20STAPLE%3ACOMPILE-SOURCE" class="xref">COMPILE-SOURCE</a></pre></div> </article> </li>  <li> <article class="definition class" id="CLASS STAPLE:DEFINITIONS-INDEX-PAGE"> <header> <span class="visibility">EXTERNAL</span> <span class="type">CLASS</span> <h4 class="name"> <a href="#CLASS%20STAPLE%3ADEFINITIONS-INDEX-PAGE">DEFINITIONS-INDEX-PAGE</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments"></ul>  <a class="source-link" href="https://github.com/Shinmera/staple/blob/master/page.lisp#L130">Source</a>  </header> <div class="docstring"><pre>Superclass for pages that include a definitions index.

See <a href="#GENERIC-FUNCTION%20STAPLE%3APACKAGES" class="xref">PACKAGES</a>
See <a href="#GENERIC-FUNCTION%20STAPLE%3AFORMAT-DOCUMENTATION" class="xref">FORMAT-DOCUMENTATION</a>
See <a href="#GENERIC-FUNCTION%20STAPLE%3ARESOLVE-SOURCE-LINK" class="xref">RESOLVE-SOURCE-LINK</a>
See <a href="#GENERIC-FUNCTION%20STAPLE%3ADEFINITION-WANTED-P" class="xref">DEFINITION-WANTED-P</a>
See <a href="#GENERIC-FUNCTION%20STAPLE%3ADEFINITIONS" class="xref">DEFINITIONS</a></pre></div> </article> </li>  <li> <article class="definition class" id="CLASS STAPLE:INPUT-PAGE"> <header> <span class="visibility">EXTERNAL</span> <span class="type">CLASS</span> <h4 class="name"> <a href="#CLASS%20STAPLE%3AINPUT-PAGE">INPUT-PAGE</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments"></ul>  <a class="source-link" href="https://github.com/Shinmera/staple/blob/master/page.lisp#L53">Source</a>  </header> <div class="docstring"><pre>Superclass for pages that are generated using some kind of input.

See <a href="#CLASS%20STAPLE%3APAGE" class="xref">PAGE</a>
See <a href="#GENERIC-FUNCTION%20STAPLE%3AINPUT" class="xref">INPUT</a></pre></div> </article> </li>  <li> <article class="definition class" id="CLASS STAPLE:PAGE"> <header> <span class="visibility">EXTERNAL</span> <span class="type">CLASS</span> <h4 class="name"> <a href="#CLASS%20STAPLE%3APAGE">PAGE</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments"></ul>  <a class="source-link" href="https://github.com/Shinmera/staple/blob/master/page.lisp#L11">Source</a>  </header> <div class="docstring"><pre>Base class for all pages that can be generated as part of a project.

A page represents a single, well, page within the documentation for a
particular project. It should only produce a single output, which
is typically a file. A page should, if possible, only contain text in
a single language. This primary language is indicated by the page's
LANGUAGE slot and defaults to &quot;en&quot; for English.

If the output is a pathname, the behaviour on existing output may be
specified through the :IF-EXISTS argument to GENERATE, by default set
to :ERROR.

See <a href="#GENERIC-FUNCTION%20STAPLE%3APROJECT" class="xref">PROJECT</a>
See <a href="#GENERIC-FUNCTION%20STAPLE%3ATITLE" class="xref">TITLE</a>
See <a href="#GENERIC-FUNCTION%20STAPLE%3ALANGUAGE" class="xref">LANGUAGE</a>
See <a href="#GENERIC-FUNCTION%20STAPLE%3AOUTPUT" class="xref">OUTPUT</a>
See <a href="#GENERIC-FUNCTION%20STAPLE%3AGENERATE" class="xref">GENERATE</a></pre></div> </article> </li>  <li> <article class="definition class" id="CLASS STAPLE:PROJECT"> <header> <span class="visibility">EXTERNAL</span> <span class="type">CLASS</span> <h4 class="name"> <a href="#CLASS%20STAPLE%3APROJECT">PROJECT</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments"></ul>  <a class="source-link" href="https://github.com/Shinmera/staple/blob/master/project.lisp#L15">Source</a>  </header> <div class="docstring"><pre>Superclass for a documentation project.

A project encapsulates all documentation for a library or program.
Typically this is expressed by a number of PAGEs that will create the
expected documentation files when the project is GENERATEd.

The OUTPUT of a project represents the root directory of all output
data. It is used to figure out relative paths between pages and
resources.

See <a href="#GENERIC-FUNCTION%20STAPLE%3AOUTPUT" class="xref">OUTPUT</a>
See <a href="#CLASS%20STAPLE%3APAGE" class="xref">PAGE</a>
See <a href="#GENERIC-FUNCTION%20STAPLE%3APAGES" class="xref">PAGES</a>
See <a href="#GENERIC-FUNCTION%20STAPLE%3AGENERATE" class="xref">GENERATE</a></pre></div> </article> </li>  <li> <article class="definition class" id="CLASS STAPLE:SIMPLE-PAGE"> <header> <span class="visibility">EXTERNAL</span> <span class="type">CLASS</span> <h4 class="name"> <a href="#CLASS%20STAPLE%3ASIMPLE-PAGE">SIMPLE-PAGE</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments"></ul>  <a class="source-link" href="https://github.com/Shinmera/staple/blob/master/inference.lisp#L18">Source</a>  </header> <div class="docstring"><pre>A simple page to base documentation on.

Simple-pages are the preferred pages to use for inferred systems.
They provide a convenient all-in-one package for a definitions index
and a documentation body.

A single &quot;document&quot; makes up the main body of the page and should
provide the primary documentation of the system or project. The
document is transformed by COMPILE-SOURCE, which by default will
automatically parse it from file and mark up code snippets within it.

If the OUTPUT pathname passed as initarg to this class is missing the
name and type, then the pathname is augmented using FILENAME of the
page.

See <a href="#VARIABLE%20STAPLE%3A%2ADEFAULT-TEMPLATE%2A" class="xref">*DEFAULT-TEMPLATE*</a>
See <a href="#GENERIC-FUNCTION%20STAPLE%3ADOCUMENT" class="xref">DOCUMENT</a>
See <a href="#GENERIC-FUNCTION%20STAPLE%3AIMAGES" class="xref">IMAGES</a>
See <a href="#GENERIC-FUNCTION%20STAPLE%3AFILENAME" class="xref">FILENAME</a>
See <a href="#CLASS%20STAPLE%3ASYSTEM-PAGE" class="xref">SYSTEM-PAGE</a>
See <a href="#GENERIC-FUNCTION%20STAPLE%3ACOMPILE-SOURCE" class="xref">COMPILE-SOURCE</a></pre></div> </article> </li>  <li> <article class="definition class" id="CLASS STAPLE:SIMPLE-PROJECT"> <header> <span class="visibility">EXTERNAL</span> <span class="type">CLASS</span> <h4 class="name"> <a href="#CLASS%20STAPLE%3ASIMPLE-PROJECT">SIMPLE-PROJECT</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments"></ul>  <a class="source-link" href="https://github.com/Shinmera/staple/blob/master/project.lisp#L34">Source</a>  </header> <div class="docstring"><pre>A simple project.

This class simply stores a list of page instances and generates them
when GENERATE is called on the project instance.

See <a href="#GENERIC-FUNCTION%20STAPLE%3APROJECT" class="xref">PROJECT</a>
See <a href="#GENERIC-FUNCTION%20STAPLE%3APAGES" class="xref">PAGES</a></pre></div> </article> </li>  <li> <article class="definition class" id="CLASS STAPLE:STATIC-PAGE"> <header> <span class="visibility">EXTERNAL</span> <span class="type">CLASS</span> <h4 class="name"> <a href="#CLASS%20STAPLE%3ASTATIC-PAGE">STATIC-PAGE</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments"></ul>  <a class="source-link" href="https://github.com/Shinmera/staple/blob/master/page.lisp#L64">Source</a>  </header> <div class="docstring"><pre>A static page that simply copies its input to its output.

This is useful for static files such as images and other resources.

See <a href="#CLASS%20STAPLE%3AINPUT-PAGE" class="xref">INPUT-PAGE</a></pre></div> </article> </li>  <li> <article class="definition class" id="CLASS STAPLE:SYSTEM-PAGE"> <header> <span class="visibility">EXTERNAL</span> <span class="type">CLASS</span> <h4 class="name"> <a href="#CLASS%20STAPLE%3ASYSTEM-PAGE">SYSTEM-PAGE</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments"></ul>  <a class="source-link" href="https://github.com/Shinmera/staple/blob/master/page.lisp#L202">Source</a>  </header> <div class="docstring"><pre>Superclass for pages that represent and ASDF system.

This system will compute several properties automatically by using the
ASDF metadata: if the :PACKAGES are not given, they are computed from
calling PACKAGES on the system object. When a source link is resolved
and the project's homepage resides on GitHub, it will try to guess a
link to the GitHub repository's viewer of the source file.

See <a href="#GENERIC-FUNCTION%20STAPLE%3ASYSTEM" class="xref">SYSTEM</a>
See <a href="#CLASS%20STAPLE%3ADEFINITIONS-INDEX-PAGE" class="xref">DEFINITIONS-INDEX-PAGE</a></pre></div> </article> </li>  <li> <article class="definition class" id="CLASS STAPLE:TEMPLATED-PAGE"> <header> <span class="visibility">EXTERNAL</span> <span class="type">CLASS</span> <h4 class="name"> <a href="#CLASS%20STAPLE%3ATEMPLATED-PAGE">TEMPLATED-PAGE</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments"></ul>  <a class="source-link" href="https://github.com/Shinmera/staple/blob/master/page.lisp#L103">Source</a>  </header> <div class="docstring"><pre>Superclass for pages that are templated using Clip.

The template that Clip is run on is the INPUT of the page. The
template arguments are computed using the TEMPLATE-DATA generic
function.

The output of the page is compressed using COMPACT if the :COMPACT
argument to GENERATE is non-NIL (default).

See <a href="#CLASS%20STAPLE%3AINPUT-PAGE" class="xref">INPUT-PAGE</a>
See <a href="#GENERIC-FUNCTION%20STAPLE%3ATEMPLATE-DATA" class="xref">TEMPLATE-DATA</a></pre></div> </article> </li>  <li> <article class="definition condition" id="CONDITION STAPLE:NO-KNOWN-OUTPUT-DIRECTORY"> <header> <span class="visibility">EXTERNAL</span> <span class="type">CONDITION</span> <h4 class="name"> <a href="#CONDITION%20STAPLE%3ANO-KNOWN-OUTPUT-DIRECTORY">NO-KNOWN-OUTPUT-DIRECTORY</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments"></ul>  <a class="source-link" href="https://github.com/Shinmera/staple/blob/master/inference.lisp#L101">Source</a>  </header> <div class="docstring"><pre>Error signalled when no known output directory is available for a system.

See <a href="#GENERIC-FUNCTION%20STAPLE%3ASYSTEM" class="xref">SYSTEM</a>
See <a href="#GENERIC-FUNCTION%20STAPLE%3AINFER-PROJECT" class="xref">INFER-PROJECT</a></pre></div> </article> </li>  <li> <article class="definition type-definition" id="TYPE STAPLE:STREAM-DESIGNATOR"> <header> <span class="visibility">EXTERNAL</span> <span class="type">TYPE-DEFINITION</span> <h4 class="name"> <a href="#TYPE%20STAPLE%3ASTREAM-DESIGNATOR">STREAM-DESIGNATOR</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments"></ul>  <a class="source-link" href="file:///media/DATA/Projects/c/sbcl/src/compiler/deftype.lisp#12:0">Source</a>  </header> <div class="docstring"><pre>A type representing all possible values to be used with ENSURE-STREAM.

See <a href="#FUNCTION%20STAPLE%3AENSURE-STREAM" class="xref">ENSURE-STREAM</a></pre></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION STAPLE:ABSOLUTE-SOURCE-LOCATION"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20STAPLE%3AABSOLUTE-SOURCE-LOCATION">ABSOLUTE-SOURCE-LOCATION</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">SOURCE-LOCATION</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/staple/blob/master/toolkit.lisp#L214">Source</a>  </header> <div class="docstring"><pre>Translates the given Definitions source-location into an absolute one.

This will read the source file to determine the absolute row/line and
col/char pointed at by the source-location. It returns another plist
of the following keys:

   :FILE    --- The same as in the input.
   :OFFSET  --- The absolute file-position offset.
   :ROW     --- The row/line of the offset.
   :COL     --- The col/char of the offset.

Returns NIL if the file cannot be found, the source-location is NIL,
or the file cannot be parsed.

See <a href="#FUNCTION%20STAPLE%3ASKIP-TO-SOURCE-FORM" class="xref">SKIP-TO-SOURCE-FORM</a></pre></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION STAPLE:ENSURE-PACKAGE"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20STAPLE%3AENSURE-PACKAGE">ENSURE-PACKAGE</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">PACKAGE</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/staple/blob/master/toolkit.lisp#L193">Source</a>  </header> <div class="docstring"><pre>Turns the given thing into a CL:PACKAGE.

If the thing cannot be coerced, an error is signalled.</pre></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION STAPLE:ENSURE-PACKAGE-DEFINITION"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20STAPLE%3AENSURE-PACKAGE-DEFINITION">ENSURE-PACKAGE-DEFINITION</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">PACKAGE</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/staple/blob/master/toolkit.lisp#L186">Source</a>  </header> <div class="docstring"><pre>Turns the given thing into a DEFINITIONS:PACKAGE.

If the thing cannot be coerced, an error is signalled.</pre></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION STAPLE:EXTRACT-LANGUAGE"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20STAPLE%3AEXTRACT-LANGUAGE">EXTRACT-LANGUAGE</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">STRING</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/staple/blob/master/toolkit.lisp#L244">Source</a>  </header> <div class="docstring"><pre>Attempts to find a valid two or three-letter language code in the string.

If a code can be found, two values are returned: the code itself and
the list of names for the language the code points to.

See <a href="https://github.com/Shinmera/language-codes#GENERIC-FUNCTION%20LANGUAGE-CODES%3ANAMES" class="xref">LANGUAGE-CODES:NAMES</a></pre></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION STAPLE:FIND-DEFINITIONS-FOR-IDENTIFIER"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20STAPLE%3AFIND-DEFINITIONS-FOR-IDENTIFIER">FIND-DEFINITIONS-FOR-IDENTIFIER</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">NAME</li>    <li class="argument lambda-list-keyword">&amp;KEY</li>    <li class="argument">PACKAGE</li>    <li class="argument">TYPE</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/staple/blob/master/xref.lisp#L90">Source</a>  </header> <div class="docstring"><pre>Attempts to find all definitions for the given symbol identifier.

The symbol is given in two parts -- as its name, and package.
The list of returned definitions may optionally be filtered by the
given type argument.

If no package is given, the definitions are attempted to be found in
the packages stored in *PAGE*, or the CL package.

See <a href="#VARIABLE%20STAPLE%3A%2APAGE%2A" class="xref">*PAGE*</a>
See <a href="#GENERIC-FUNCTION%20STAPLE%3APACKAGES" class="xref">PACKAGES</a>
See <a href="https://Shinmera.github.io/definitions/#GENERIC-FUNCTION%20DEFINITIONS%3AFIND-DEFINITIONS" class="xref">DEFINITIONS:FIND-DEFINITIONS</a></pre></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION STAPLE:FIND-FILES"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20STAPLE%3AFIND-FILES">FIND-FILES</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">DIRECTORY</li>    <li class="argument">PATTERNS</li>    <li class="argument lambda-list-keyword">&amp;KEY</li>    <li class="argument">MAX-DEPTH</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/staple/blob/master/toolkit.lisp#L105">Source</a>  </header> <div class="docstring"><pre>Find all files in the directory tree that match one of the patterns.

The patterns should be regular expressions suitable for CL-PPCRE. They
are matched against the file-namestrings of the files in the directory
tree.

See <a href="#MACRO-FUNCTION%20STAPLE%3ADO-DIRECTORY-TREE" class="xref">DO-DIRECTORY-TREE</a></pre></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION STAPLE:LOAD-EXTENSION"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20STAPLE%3ALOAD-EXTENSION">LOAD-EXTENSION</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">SYSTEM</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/staple/blob/master/project.lisp#L57">Source</a>  </header> <div class="docstring"><pre>Loads the extension file of the system.

This ensures that all Staple extensions and customisations that the
system might need are present and loaded when the documentation is
generated.

It proceeds as follows:
1. The argument is coerced to an ASDF:SYSTEM
2. If the system was already involved in a LOAD-EXTENSION call within
   this call tree, NIL is returned immediately.
3. Otherwise the system is loaded via ASDF:LOAD-SYSTEM, with warnings
   and standard-output muffled.
4. For each dependency registered for the system, LOAD-EXTENSION is
   called again to ensure dependant extensions are loaded first.
5. The EXTENSION-FILE, if present, is LOADed.
6. The system is returned.

See ASDF:LOAD-SYSTEM
See <a href="http://l1sp.org/cl/load" class="xref">CL:LOAD</a></pre></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION STAPLE:LOAD-SYSTEM-QUIETLY"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20STAPLE%3ALOAD-SYSTEM-QUIETLY">LOAD-SYSTEM-QUIETLY</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">SYSTEM</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/staple/blob/master/toolkit.lisp#L329">Source</a>  </header> <div class="docstring"><pre>Loads the given ASDF:SYSTEM quietly.

This muffles warnings and suppresses *standard-output*.

See ASDF:LOAD-SYSTEM</pre></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION STAPLE:MARKUP-CODE-BLOCK"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20STAPLE%3AMARKUP-CODE-BLOCK">MARKUP-CODE-BLOCK</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">NODE</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/staple/blob/master/code-format.lisp#L44">Source</a>  </header> <div class="docstring"><pre>Transforms the node's content treating it as a code block.

Only the textual contents of the node are inspected, any other kinds
of tag that may be a child to the block will be removed by this.

All definitions that are recognised in this that have a result for
XREF will be marked up by an &lt;a&gt; tag with the class &quot;xref&quot;.

Note that the value of *PACKAGE* matters for the parsing of the
code blocks, as a full READ and walk is performed on it to find
symbols and their usage in the code snippet.

Note also that if invalid code or non-lisp code is encountered an
error may be signalled by the reader.

See <a href="#GENERIC-FUNCTION%20STAPLE%3AXREF" class="xref">XREF</a>
See <a href="staple-code-parser/index.html#GENERIC-FUNCTION%20STAPLE-CODE-PARSER%3APARSE" class="xref">STAPLE-CODE-PARSER:PARSE</a>
See <a href="staple-code-parser/index.html#FUNCTION%20STAPLE-CODE-PARSER%3APARSE-RESULT-%3EDEFINITION-LIST" class="xref">STAPLE-CODE-PARSER:PARSE-RESULT-&gt;DEFINITION-LIST</a></pre></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION STAPLE:MARKUP-CODE-REFERENCE"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20STAPLE%3AMARKUP-CODE-REFERENCE">MARKUP-CODE-REFERENCE</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">NODE</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/staple/blob/master/code-format.lisp#L62">Source</a>  </header> <div class="docstring"><pre>Transforms the node's content treating it as a definition reference.

Only the textual contents of the node are inspected, any other kinds
of tag that may be a child to the block will be removed by this.

This simply uses XREF on the textual content and if a result is
returned, inserts an &lt;a&gt; tag with the class &quot;xref&quot; to provide the
link.

See <a href="#GENERIC-FUNCTION%20STAPLE%3AXREF" class="xref">XREF</a></pre></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION STAPLE:MARKUP-CODE-SNIPPETS"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20STAPLE%3AMARKUP-CODE-SNIPPETS">MARKUP-CODE-SNIPPETS</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">HTML</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/staple/blob/master/code-format.lisp#L16">Source</a>  </header> <div class="docstring"><pre>Attempts to mark up the code snippets in the given HTML text.

This looks for &lt;code&gt; tags within the given HTML and will try to
automatically insert xref links. It performs transformations as
follows: Each &lt;code&gt; tag that is direct child to a &lt;pre&gt; tag is
transformed using MARKUP-CODE-BLOCK, with the intention that the
&lt;code&gt; element contains full code snippets. &lt;code&gt; tags without a
&lt;pre&gt; parent will be transformed using MARKUP-CODE-REFERENCE,
with the idea that these will only contain single symbol names that
represent direct references to definitions.

If an error occurs during the markup of a tag, a SKIP-TAG restart
will be available to allow skipping that particular tag.

The return value of this function is a PLUMP:NODE if the argument
is also a PLUMP:NODE, and a STRING if the argument is either a
STRING or a PATHNAME.

See <a href="#FUNCTION%20STAPLE%3AMARKUP-CODE-BLOCK" class="xref">MARKUP-CODE-BLOCK</a>
See <a href="#FUNCTION%20STAPLE%3AMARKUP-CODE-REFERENCE" class="xref">MARKUP-CODE-REFERENCE</a></pre></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION STAPLE:MARKUP-CODE-SNIPPETS-IGNORING-ERRORS"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20STAPLE%3AMARKUP-CODE-SNIPPETS-IGNORING-ERRORS">MARKUP-CODE-SNIPPETS-IGNORING-ERRORS</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">HTML</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/staple/blob/master/code-format.lisp#L9">Source</a>  </header> <div class="docstring"><pre>Marks up the code snippets ignoring parts that fail during markup.

See <a href="#FUNCTION%20STAPLE%3AMARKUP-CODE-SNIPPETS" class="xref">MARKUP-CODE-SNIPPETS</a></pre></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION STAPLE:MAYBE-LANG-DOCSTRING"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20STAPLE%3AMAYBE-LANG-DOCSTRING">MAYBE-LANG-DOCSTRING</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">DEFINITION</li>    <li class="argument">LANGUAGE</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/staple/blob/master/toolkit.lisp#L251">Source</a>  </header> <div class="docstring"><pre>Attempts to find a docstring for the given definition in the given language.

If the multilang-documentation system is loaded, then this consults
MULTILANG-DOCUMENTATION:DOCUMENTATION using the DEFINITIONS:OBJECT
and T as arguments, and alternatively the DEFINITIONS:DESIGNATOR and
DEFINITIONS:TYPE. If either the system is not loaded, or it fails to
return anything for both queries, it falls back to just returning the
DEFINITIONS:DOCUMENTATION.

See MULTILANG-DOCUMENTATION:DOCUMENTATION
See <a href="https://Shinmera.github.io/definitions/#GENERIC-FUNCTION%20DEFINITIONS%3ADOCUMENTATION" class="xref">DEFINITIONS:DOCUMENTATION</a></pre></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION STAPLE:PATHNAME-TYPE-&gt;TYPE"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20STAPLE%3APATHNAME-TYPE-%3ETYPE">PATHNAME-TYPE-&gt;TYPE</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">TYPE</li>    <li class="argument lambda-list-keyword">&amp;OPTIONAL</li>    <li class="argument">ERRORP</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/staple/blob/master/transform.lisp#L11">Source</a>  </header> <div class="docstring"><pre>Returns a keyword for the given pathname-type, if it is known.

If ERRORP is non-NIL and no type can be found, an error is signalled.

When used as a setf-place, the value should be a list of pathname-type
strings that should be associated with the given type. Note that this
is overriding, meaning that previous associations to the given type
are removed.

See <a href="#GENERIC-FUNCTION%20STAPLE%3ACOMPILE-SOURCE" class="xref">COMPILE-SOURCE</a>
See <a href="#MACRO-FUNCTION%20STAPLE%3ADEFINE-SOURCE-COMPILER" class="xref">DEFINE-SOURCE-COMPILER</a></pre></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION STAPLE:(SETF PATHNAME-TYPE-&gt;TYPE)"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20STAPLE%3A%28SETF%20PATHNAME-TYPE-%3ETYPE%29">(SETF PATHNAME-TYPE-&gt;TYPE)</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">TYPES</li>    <li class="argument">TYPE</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/staple/blob/master/transform.lisp#L17">Source</a>  </header> <div class="docstring"><i>No documentation provided.</i></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION STAPLE:PREFERRED-DEFINITION"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20STAPLE%3APREFERRED-DEFINITION">PREFERRED-DEFINITION</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">DEFINITIONS</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/staple/blob/master/toolkit.lisp#L172">Source</a>  </header> <div class="docstring"><pre>Returns the list sorted such that the most important, or preferred definitions, come first.

See <a href="#GENERIC-FUNCTION%20STAPLE%3ADEFINITION-IMPORTANCE" class="xref">DEFINITION-IMPORTANCE</a></pre></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION STAPLE:PURIFY-ARGLIST"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20STAPLE%3APURIFY-ARGLIST">PURIFY-ARGLIST</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">ARGLIST</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/staple/blob/master/toolkit.lisp#L337">Source</a>  </header> <div class="docstring"><pre>Purifies the given arguments list / lambda-list.

This function is useful for presenting the user-interface part of
a lambda-list. Thus it trims all extraneous information that the
user of a function or macro does not need to know about.

Specifically this does the following, depending on the current
lambda-list-keyword in the arglist:

  REQUIRED     --- The argument is purified recursively if it is a
                   list, and retained verbatim otherwise.
  &amp;OPTIONAL    --- Only the variable name is retained.
  &amp;KEY         --- Only the variable's keyword-name is retained.
  &amp;WHOLE       --- The argument is removed.
  &amp;ENVIRONMENT --- The argument is removed.
  &amp;AUX         --- The argument is removed.</pre></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION STAPLE:READ-FILE"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20STAPLE%3AREAD-FILE">READ-FILE</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">PATH</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/staple/blob/master/toolkit.lisp#L112">Source</a>  </header> <div class="docstring"><pre>Reads the given file to a string and returns it.</pre></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION STAPLE:REMOVE-XREF-RESOLVER"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20STAPLE%3AREMOVE-XREF-RESOLVER">REMOVE-XREF-RESOLVER</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">NAME</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/staple/blob/master/xref.lisp#L18">Source</a>  </header> <div class="docstring"><pre>Removes the cross-reference resolver of the given name.

See <a href="#FUNCTION%20STAPLE%3AXREF-RESOLVER" class="xref">XREF-RESOLVER</a></pre></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION STAPLE:RESOLVE-XREF"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20STAPLE%3ARESOLVE-XREF">RESOLVE-XREF</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">DEFINITION</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/staple/blob/master/xref.lisp#L27">Source</a>  </header> <div class="docstring"><pre>Calls each cross-reference resolver with the definition until one returns a valid reference.

See <a href="#FUNCTION%20STAPLE%3AXREF-RESOLVER" class="xref">XREF-RESOLVER</a>
See <a href="#MACRO-FUNCTION%20STAPLE%3ADEFINE-XREF-RESOLVER" class="xref">DEFINE-XREF-RESOLVER</a></pre></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION STAPLE:SORT-DEFINITIONS"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20STAPLE%3ASORT-DEFINITIONS">SORT-DEFINITIONS</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">DEFINITIONS</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/staple/blob/master/toolkit.lisp#L156">Source</a>  </header> <div class="docstring"><pre>Sorts the list of definitions into a natural order.

Definitions of different type are sorted by DEFINITION-ORDER.
Definitions of the same type are sorted by STRING&lt; using
DEFINITIONS:NAME as the key.

The sort is performed stably.

See <a href="#GENERIC-FUNCTION%20STAPLE%3ADEFINITION-ORDER" class="xref">DEFINITION-ORDER</a></pre></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION STAPLE:URL-ENCODE"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20STAPLE%3AURL-ENCODE">URL-ENCODE</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">THING</li>    <li class="argument lambda-list-keyword">&amp;OPTIONAL</li>    <li class="argument">EXTERNAL-FORMAT</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/staple/blob/master/toolkit.lisp#L175">Source</a>  </header> <div class="docstring"><pre>Performs percent, or url-encoding of the string.</pre></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION STAPLE:XREF-RESOLVER"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20STAPLE%3AXREF-RESOLVER">XREF-RESOLVER</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">NAME</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/staple/blob/master/xref.lisp#L11">Source</a>  </header> <div class="docstring"><pre>Accessor to the cross-reference resolver of the given name.

The resolver should be a function of one argument, a definition
instance. It should return either NIL, or a URL string.

Default xref-resolvers for the current page that's being generated,
and the common-lisp package, are defined.

It is useful to define addition resolvers if you have some kind of
source of documentation that you would like to be able to link to.

Resolvers allow an optional priority number to control in which
order they're invoked. When reading the resolver, the priority is
returned as the second value.

See <a href="#FUNCTION%20STAPLE%3AREMOVE-XREF-RESOLVER" class="xref">REMOVE-XREF-RESOLVER</a>
See <a href="#MACRO-FUNCTION%20STAPLE%3ADEFINE-XREF-RESOLVER" class="xref">DEFINE-XREF-RESOLVER</a>
See <a href="#FUNCTION%20STAPLE%3ARESOLVE-XREF" class="xref">RESOLVE-XREF</a></pre></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION STAPLE:(SETF XREF-RESOLVER)"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20STAPLE%3A%28SETF%20XREF-RESOLVER%29">(SETF XREF-RESOLVER)</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">FUNCTION</li>    <li class="argument">NAME</li>    <li class="argument lambda-list-keyword">&amp;OPTIONAL</li>    <li class="argument">PRIORITY</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/staple/blob/master/xref.lisp#L15">Source</a>  </header> <div class="docstring"><i>No documentation provided.</i></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION STAPLE:COMPILE-SOURCE"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20STAPLE%3ACOMPILE-SOURCE">COMPILE-SOURCE</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">SOURCE</li>    <li class="argument">TYPE</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/staple/blob/master/transform.lisp#L28">Source</a>  </header> <div class="docstring"><pre>Compiles the source to a usable format, interpreting it as the given type.

The following argument combinations have specifically defined
behaviour:

  Source:  Type:        Explanation:
  --------------------------------------------------------------------
  PATHNAME (EQL T)  --- COMPILE-SOURCE is called again using the
                        pathname's pathname-type as type argument.
  PATHNAME       T  --- COMPILE-SOURCE is called again using the
                        contents of the file in string form as source
                        argument.
         T  STRING  --- COMPILE-SOURCE is called again using the type
                        returned by PATHNAME-TYPE-&gt;TYPE as the type
                        argument.

You should add methods to this function specialising on a particular
source type to handle the translation appropriately.

See <a href="#FUNCTION%20STAPLE%3APATHNAME-TYPE-%3ETYPE" class="xref">PATHNAME-TYPE-&gt;TYPE</a>
See <a href="#MACRO-FUNCTION%20STAPLE%3ADEFINE-SOURCE-COMPILER" class="xref">DEFINE-SOURCE-COMPILER</a></pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION STAPLE:DEFINITION-ID"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20STAPLE%3ADEFINITION-ID">DEFINITION-ID</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">DEFINITION</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/staple/blob/master/toolkit.lisp#L120">Source</a>  </header> <div class="docstring"><pre>Returns a string representing a unique ID for the given definition.

This is useful for creating links and anchors for definitions in a
document.</pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION STAPLE:DEFINITION-IMPORTANCE"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20STAPLE%3ADEFINITION-IMPORTANCE">DEFINITION-IMPORTANCE</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">DEFINITION</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/staple/blob/master/toolkit.lisp#L165">Source</a>  </header> <div class="docstring"><pre>Returns a number for the given definition, used to determine if one definition should receive precedence over another.

By default, the following sorting is applied:

  DEFINITIONS:CALLABLE           30
  DEFINITIONS:TYPE               20
  DEFINITIONS:VARIABLE           10
  DEFINITIONS:DEFINITION          0
  DEFINITIONS:METHOD            -10

See <a href="#FUNCTION%20STAPLE%3APREFERRED-DEFINITION" class="xref">PREFERRED-DEFINITION</a></pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION STAPLE:DEFINITION-ORDER"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20STAPLE%3ADEFINITION-ORDER">DEFINITION-ORDER</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">DEFINITION</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/staple/blob/master/toolkit.lisp#L133">Source</a>  </header> <div class="docstring"><pre>Returns a number for the given definition, used for sorting.

The higher the number, the earlier the definition should appear in the
sorting.

By default, the following sorting is applied:

  DEFINITIONS:PACKAGE            200
  DEFINITIONS:CONSTANT           190
  DEFINITIONS:SYMBOL-MACRO       180
  DEFINITIONS:SPECIAL-VARIABLE   170
  DEFINITIONS:VARIABLE           160
  DEFINITIONS:CLASS              150
  DEFINITIONS:CONDITION          140
  DEFINITIONS:STRUCTURE          130
  DEFINITIONS:TYPE-DEFINITION    120
  DEFINITIONS:TYPE               110
  DEFINITIONS:ACCESSOR           100
  DEFINITIONS:FUNCTION            90
  DEFINITIONS:GENERIC-FUNCTION    80
  DEFINITIONS:METHOD              70
  DEFINITIONS:COMPILER-MACRO      60
  DEFINITIONS:MACRO               50
  DEFINITIONS:SETF-EXPANDER       40
  DEFINITIONS:CALLABLE            30
  DEFINITIONS:METHOD-COMBINATION  20
  DEFINITIONS:GLOBAL-DEFINITION   10
  DEFINITIONS:DEFINITION           0

See <a href="#FUNCTION%20STAPLE%3ASORT-DEFINITIONS" class="xref">SORT-DEFINITIONS</a></pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION STAPLE:DEFINITION-WANTED-P"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20STAPLE%3ADEFINITION-WANTED-P">DEFINITION-WANTED-P</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">DEFINITION</li>    <li class="argument">PAGE</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/staple/blob/master/page.lisp#L188">Source</a>  </header> <div class="docstring"><pre>This function should return T if the definition should be included in the page's definitions index.

See <a href="#CLASS%20STAPLE%3ADEFINITIONS-INDEX-PAGE" class="xref">DEFINITIONS-INDEX-PAGE</a></pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION STAPLE:DEFINITIONS"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20STAPLE%3ADEFINITIONS">DEFINITIONS</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">PAGE</li>    <li class="argument">PACKAGE</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/staple/blob/master/page.lisp#L193">Source</a>  </header> <div class="docstring"><pre>This function should return a list of applicable definitions for the given page and package.

By default this will simply compute /all/ definitions in the package
and only keeping wanted ones by DEFINITION-WANTED-P.

The returned list of definitions is always sorted in the natural order
as described by SORT-DEFINITIONS.

See <a href="#GENERIC-FUNCTION%20STAPLE%3ADEFINITION-WANTED-P" class="xref">DEFINITION-WANTED-P</a>
See <a href="#FUNCTION%20STAPLE%3ASORT-DEFINITIONS" class="xref">SORT-DEFINITIONS</a></pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION STAPLE:DOCUMENT"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20STAPLE%3ADOCUMENT">DOCUMENT</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">OBJECT</li>  </ul>  </header> <div class="docstring"><pre>Accessor for the document the simple-page will include in its body.

This should be a pathname to a file that can be parsed by
COMPILE-SOURCE.

See <a href="#CLASS%20STAPLE%3ASIMPLE-PAGE" class="xref">SIMPLE-PAGE</a>
See <a href="#GENERIC-FUNCTION%20STAPLE%3ACOMPILE-SOURCE" class="xref">COMPILE-SOURCE</a></pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION STAPLE:(SETF DOCUMENT)"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20STAPLE%3A%28SETF%20DOCUMENT%29">(SETF DOCUMENT)</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">NEW-VALUE</li>    <li class="argument">OBJECT</li>  </ul>  </header> <div class="docstring"><i>No documentation provided.</i></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION STAPLE:DOCUMENTS"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20STAPLE%3ADOCUMENTS">DOCUMENTS</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">SYSTEM</li>  </ul>  </header> <div class="docstring"><pre>Returns a list of pathnames to documents relevant for the given system.

By default this will attempt a heuristic by searching for files that
can be parsed by PATHNAME-TYPE-&gt;TYPE, and match one of the
*DOCUMENT-PATTERNS* within the system's source directory.

You may add a method specialising on a particular system to change
which documents are used for an inferred project.

See <a href="#FUNCTION%20STAPLE%3APATHNAME-TYPE-%3ETYPE" class="xref">PATHNAME-TYPE-&gt;TYPE</a>
See <a href="#VARIABLE%20STAPLE%3A%2ADOCUMENT-PATTERNS%2A" class="xref">*DOCUMENT-PATTERNS*</a>
See <a href="#GENERIC-FUNCTION%20STAPLE%3AINFER-PROJECT" class="xref">INFER-PROJECT</a></pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION STAPLE:EXTENSION-FILE"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20STAPLE%3AEXTENSION-FILE">EXTENSION-FILE</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">SYSTEM</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/staple/blob/master/project.lisp#L39">Source</a>  </header> <div class="docstring"><pre>Returns the Staple extension source file for the ASDF:SYSTEM.

By default this is a file called &quot;staple.ext.lisp&quot; within the
system's source directory.

This function may return NIL to indicate that the system has no
extension file.

See ASDF:SYSTEM-SOURCE-DIRECTORY</pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION STAPLE:FILENAME"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20STAPLE%3AFILENAME">FILENAME</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">PAGE</li>  </ul>  </header> <div class="docstring"><pre>Returns a suitable pathname making up the filename of the page.

By default for simple-pages this is the name &quot;index&quot; followed by
the language code of the page, if the language is not :en or :eng,
and the type &quot;html&quot;.

See <a href="#CLASS%20STAPLE%3ASIMPLE-PAGE" class="xref">SIMPLE-PAGE</a></pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION STAPLE:FIND-PROJECT"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20STAPLE%3AFIND-PROJECT">FIND-PROJECT</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">PROJECT</li>    <li class="argument lambda-list-keyword">&amp;KEY</li>    <li class="argument lambda-list-keyword">&amp;ALLOW-OTHER-KEYS</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/staple/blob/master/project.lisp#L45">Source</a>  </header> <div class="docstring"><pre>Find and return the project for the given project designator.

Typically the project designator will be an ASDF:SYSTEM.

If you want to define a custom project for your system, you should
add a method specialising on your system instance to this function
and have it return the appropriately filled out project instance.

By default this will first call LOAD-EXTENSION on the system, and will
then call itself again if it can now find new methods specialising
either on the system's instance or its name as a keyword. Otherwise
it simply returns NIL.

See <a href="#FUNCTION%20STAPLE%3ALOAD-EXTENSION" class="xref">LOAD-EXTENSION</a></pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION STAPLE:FORMAT-DOCUMENTATION"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20STAPLE%3AFORMAT-DOCUMENTATION">FORMAT-DOCUMENTATION</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">DEFINITION</li>    <li class="argument">PAGE</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/staple/blob/master/page.lisp#L142">Source</a>  </header> <div class="docstring"><pre>Formats the definition according to the page's preferences.

This function should be called to retrieve fully formatted HTML to
use as the documentation for a given definition on a page.

By default this will call MAYBE-LANG-DOCSTRING on the definition and
the page's language to retrieve the raw docstring, and then call
FORMAT-DOCUMENTATION again with the docstring and the page.

If a string is passed, it will by default parse it in the &quot;See&quot;
style wherein each Line beginning with &quot;See&quot; is treated as a line
indicating a source cross-reference. The rest of the line is
interpreted as a designator for another definition and is turned into
an xref link if possible.

If you would prefer other documentation styles, you should add a
method specialising on a custom page type, then use that page type in
your project.

See <a href="#CLASS%20STAPLE%3ADEFINITIONS-INDEX-PAGE" class="xref">DEFINITIONS-INDEX-PAGE</a>
See <a href="#FUNCTION%20STAPLE%3AMAYBE-LANG-DOCSTRING" class="xref">MAYBE-LANG-DOCSTRING</a>
See <a href="#GENERIC-FUNCTION%20STAPLE%3AXREF" class="xref">XREF</a></pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION STAPLE:GENERATE"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20STAPLE%3AGENERATE">GENERATE</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">PAGE</li>    <li class="argument lambda-list-keyword">&amp;KEY</li>    <li class="argument">IF-EXISTS</li>    <li class="argument">COMPACT</li>    <li class="argument lambda-list-keyword">&amp;ALLOW-OTHER-KEYS</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/staple/blob/master/page.lisp#L30">Source</a>  </header> <div class="docstring"><pre>Generate the outputs of the given object.

The value returned by this function should be some kind of identifier
of the outputs that were generated by the call to this function.
In the case of a page, this will be the output file or result produced
by the page. In the case of a project, this will typically be the
project itself, and a list of the results from the pages it generated.

If this function is called with something that isn't a project or page
then the argument is treated as a potential ASDF:SYSTEM and is coerced
to one by ASDF:FIND-SYSTEM. It will then try to find a project for the
system by first consulting FIND-PROJECT, and then INFER-PROJECT. If
both FIND-PROJECT and INFER-PROJECT fail, an error is signalled.
Otherwise, GENERATE is called on the newly retrieved project.

See <a href="#CLASS%20STAPLE%3APAGE" class="xref">PAGE</a>
See <a href="#GENERIC-FUNCTION%20STAPLE%3APROJECT" class="xref">PROJECT</a>
See <a href="#VARIABLE%20STAPLE%3A%2APAGE%2A" class="xref">*PAGE*</a>
See <a href="#GENERIC-FUNCTION%20STAPLE%3AFIND-PROJECT" class="xref">FIND-PROJECT</a>
See <a href="#GENERIC-FUNCTION%20STAPLE%3AINFER-PROJECT" class="xref">INFER-PROJECT</a></pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION STAPLE:IMAGES"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20STAPLE%3AIMAGES">IMAGES</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">OBJECT</li>  </ul>  </header> <div class="docstring"><pre>Returns a list of pathnames to images relevant for the given system.

By default this will attempt a heuristic by searching for files that
match one of the *IMAGE-PATTERNS* within the system's source directory.

You may add a method specialising on a particular system to change
which images are used for an inferred project.

See <a href="#VARIABLE%20STAPLE%3A%2AIMAGE-PATTERNS%2A" class="xref">*IMAGE-PATTERNS*</a>
See <a href="#GENERIC-FUNCTION%20STAPLE%3AINFER-PROJECT" class="xref">INFER-PROJECT</a></pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION STAPLE:(SETF IMAGES)"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20STAPLE%3A%28SETF%20IMAGES%29">(SETF IMAGES)</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">NEW-VALUE</li>    <li class="argument">OBJECT</li>  </ul>  </header> <div class="docstring"><i>No documentation provided.</i></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION STAPLE:INFER-PROJECT"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20STAPLE%3AINFER-PROJECT">INFER-PROJECT</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">PROJECT</li>    <li class="argument lambda-list-keyword">&amp;KEY</li>    <li class="argument">OUTPUT-DIRECTORY</li>    <li class="argument">IMAGES</li>    <li class="argument">DOCUMENTS</li>    <li class="argument">PAGE-TYPE</li>    <li class="argument">TEMPLATE</li>    <li class="argument">PACKAGES</li>    <li class="argument">SUBSYSTEMS</li>    <li class="argument lambda-list-keyword">&amp;ALLOW-OTHER-KEYS</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/staple/blob/master/project.lisp#L81">Source</a>  </header> <div class="docstring"><pre>Attempts to infer a project suitable for the given ASDF:SYSTEM.

By default this consults a variety of functions and attempts to build
a suitable SIMPLE-PROJECT instance that should document the system.
If you want to control how the documentation is generated, you may
either specialise the functions INFER-PROJECT uses, or construct your
own project entirely by specialising on FIND-PROJECT instead.

INFER-PROJECT proceeds as follows:
1. If no :OUTPUT-DIRECTORY is given, it is found via OUTPUT-DIRECTORY.
2. If no :DOCUMENTS are given, they are found via DOCUMENTS.
3. If no :IMAGES are given, they are found via IMAGES.
4. If no :PAGE-TYPE is given, it is found via PAGE-TYPE.
5. If no :TEMPLATE is given, it is found via TEMPLATE.
6. If no :PACKAGES are given, they are found via PACKAGES.
7. If no :SUBSYSTEMS are given, they are found via SUBSYSTEMS.
8. If no output directory is known, a recoverable error of type
   NO-KNOWN-OUTPUT-DIRECTORY is signalled. You may use the USE-VALUE
   restart to provide a new output directory.
9. Each entry in the subsystems list may either be an ASDF system, or a
   list of an ASDF system and the same keyword arguments as above. The
   properties are inferred as follows:
9.1 If no :OUTPUT-DIRECTORY is given, a subdirectory by the name of the
    subsystem within the primary system's output directory is used.
9.2 If no :DOCUMENTS are given, they are found via DOCUMENTS.
9.3 If no :IMAGES are given, they are found via IMAGES, or the primary
    system's images are used.
9.4 If no :PAGE-TYPE is given, it is found via PAGE-TYPE, or the primary
    system's page-type is used.
9.5 If no :TEMPLATE is given, it is found via TEMPLATE, or the primary
    system's template is used.
9.6 If no :PACKAGES are given, they are found via PACKAGES.
9.7 If the subsystem's source directory is the same as the primary
    system's, and the list of documents are the same, the subsystem's
    document list is emptied to avoid the subsystem using documents
    intended for the primary system.
9.8 All documents for the subsystem are removed from the documents list
    for the primary system.
9.9 For each document for the subsystem, a page of page-type is
    constructed, passing the template as :INPUT, the output directory
    as :OUTPUT, the system as :SYSTEM, the document as :DOCUMENT, the
    list of images as :IMAGES, and the list of packages as :PACKAGES.
9.10. If the documents list is empty, a single page of page-type is
      constructed with the same arguments as before, except the
      :DOCUMENT being NIL.
9.11. For each pathname in the images list a page of type STATIC-PAGE is
      constructed that will copy the image file into the
      OUTPUT-DIRECTORY while preserving pathname name and type.
10. For each pathname in the documents list a page of page-type is
    constructed, passing the template as :INPUT, the output directory
    as :OUTPUT, the system as :SYSTEM, the document's pathname as
    :DOCUMENT, the list of images as :IMAGES, and the list of packages
    as :PACKAGES.
11. If the documents list is empty, a single page of page-type is
    constructed with the same arguments as before, except the :DOCUMENT
    being NIL.
12. For each pathname in the images list a page of type STATIC-PAGE is
    constructed that will copy the image file into the OUTPUT-DIRECTORY
    while preserving pathname name and type.
13. A SIMPLE-PROJECT instance is constructed and returned with those
    pages as the :PAGES argument.

See <a href="#GENERIC-FUNCTION%20STAPLE%3AOUTPUT-DIRECTORY" class="xref">OUTPUT-DIRECTORY</a>
See <a href="#GENERIC-FUNCTION%20STAPLE%3ADOCUMENTS" class="xref">DOCUMENTS</a>
See <a href="#GENERIC-FUNCTION%20STAPLE%3AIMAGES" class="xref">IMAGES</a>
See <a href="#GENERIC-FUNCTION%20STAPLE%3APACKAGES" class="xref">PACKAGES</a>
See <a href="#GENERIC-FUNCTION%20STAPLE%3APAGE-TYPE" class="xref">PAGE-TYPE</a>
See <a href="#GENERIC-FUNCTION%20STAPLE%3ATEMPLATE" class="xref">TEMPLATE</a>
See <a href="#GENERIC-FUNCTION%20STAPLE%3ASUBSYSTEMS" class="xref">SUBSYSTEMS</a>
See <a href="#VARIABLE%20STAPLE%3A%2ADEFAULT-TEMPLATE%2A" class="xref">*DEFAULT-TEMPLATE*</a>
See <a href="#CONDITION%20STAPLE%3ANO-KNOWN-OUTPUT-DIRECTORY" class="xref">NO-KNOWN-OUTPUT-DIRECTORY</a>
See <a href="http://l1sp.org/cl/use-value" class="xref">CL:USE-VALUE</a>
See <a href="#CLASS%20STAPLE%3ASTATIC-PAGE" class="xref">STATIC-PAGE</a>
See <a href="#CLASS%20STAPLE%3ASIMPLE-PROJECT" class="xref">SIMPLE-PROJECT</a></pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION STAPLE:INPUT"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20STAPLE%3AINPUT">INPUT</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">OBJECT</li>  </ul>  </header> <div class="docstring"><pre>Accessor to the input of the page.

The input should be a STREAM-DESIGNATOR, meaning that it can be
resolved to a stream via ENSURE-STREAM. Typically it will be a
pathname pointing to the file from which the page's input should be
ready.

See <a href="#CLASS%20STAPLE%3AINPUT-PAGE" class="xref">INPUT-PAGE</a></pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION STAPLE:(SETF INPUT)"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20STAPLE%3A%28SETF%20INPUT%29">(SETF INPUT)</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">NEW-VALUE</li>    <li class="argument">OBJECT</li>  </ul>  </header> <div class="docstring"><i>No documentation provided.</i></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION STAPLE:LANGUAGE"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20STAPLE%3ALANGUAGE">LANGUAGE</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">OBJECT</li>  </ul>  </header> <div class="docstring"><pre>Accessor to the language of a page.

The language should be a two or three-letter short-code that uniquely
identifies the language as a keyword. See the ISO-639 language codes for
all available options.

See <a href="#CLASS%20STAPLE%3APAGE" class="xref">PAGE</a></pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION STAPLE:(SETF LANGUAGE)"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20STAPLE%3A%28SETF%20LANGUAGE%29">(SETF LANGUAGE)</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">NEW-VALUE</li>    <li class="argument">OBJECT</li>  </ul>  </header> <div class="docstring"><i>No documentation provided.</i></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION STAPLE:OUTPUT"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20STAPLE%3AOUTPUT">OUTPUT</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">OBJECT</li>  </ul>  </header> <div class="docstring"><pre>Accessor to the output of a page.

The output should be a STREAM-DESIGNATOR, meaning that it can be
resolved to a stream via ENSURE-STREAM. Typically it will be a
pathname pointing to the file into which the page's contents should be
stored.

See <a href="#CLASS%20STAPLE%3APAGE" class="xref">PAGE</a></pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION STAPLE:(SETF OUTPUT)"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20STAPLE%3A%28SETF%20OUTPUT%29">(SETF OUTPUT)</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">NEW-VALUE</li>    <li class="argument">OBJECT</li>  </ul>  </header> <div class="docstring"><i>No documentation provided.</i></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION STAPLE:OUTPUT-DIRECTORY"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20STAPLE%3AOUTPUT-DIRECTORY">OUTPUT-DIRECTORY</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">SYSTEM</li>  </ul>  </header> <div class="docstring"><pre>Returns the output directory to which documentation for the given system should be output.

By default this returns the &quot;doc/&quot; subdirectory within the system's
source directory.

You may add a method specialising on a particular system to change
where the resulting content is stored for an inferred project.

See ASDF:SYSTEM-SOURCE-DIRECTORY
See <a href="#GENERIC-FUNCTION%20STAPLE%3AINFER-PROJECT" class="xref">INFER-PROJECT</a></pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION STAPLE:PACKAGE-SYSTEM"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20STAPLE%3APACKAGE-SYSTEM">PACKAGE-SYSTEM</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">PACKAGE</li>  </ul>  </header> <div class="docstring"><pre>Returns the system associated with the package.

This is typically the system that defines the package, if the package
was recorded through Staple's package recording mechanism. If this
automated detection is not smart enough, you may supply methods on
this function to specify the correct system for a package.

See <a href="http://l1sp.org/cl/package" class="xref">CL:PACKAGE</a></pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION STAPLE:PACKAGES"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20STAPLE%3APACKAGES">PACKAGES</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">SYSTEM</li>  </ul>  </header> <div class="docstring"><pre>Accessor to the list of packages associated with the instance.

This will always return a list of PACKAGE instances, not package
designators. If passed an ASDF:SYSTEM instance, it will return the
list of packages that were either recorded explicitly for the system
during loading, or were either inferred or explicitly set for the
system. If passed a DEFINITIONS-INDEX-PAGE instance, it will return
the list of packages that should be put into the index. For anything
else it will try to coerce the argument to an ASDF:SYSTEM via
ASDF:FIND-SYSTEM.

See ASDF:SYSTEM
See <a href="#CLASS%20STAPLE%3ADEFINITIONS-INDEX-PAGE" class="xref">DEFINITIONS-INDEX-PAGE</a></pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION STAPLE:(SETF PACKAGES)"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20STAPLE%3A%28SETF%20PACKAGES%29">(SETF PACKAGES)</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">PACKAGES</li>    <li class="argument">SYSTEM</li>  </ul>  </header> <div class="docstring"><i>No documentation provided.</i></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION STAPLE:PAGE-TYPE"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20STAPLE%3APAGE-TYPE">PAGE-TYPE</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">SYSTEM</li>  </ul>  </header> <div class="docstring"><pre>Returns the type of the page that should be used for the given system's inferred project.

By default this returns 'SIMPLE-PAGE

You may add a method specialising on a particular system to change
which page-type is used for an inferred project.

See <a href="#CLASS%20STAPLE%3ASIMPLE-PAGE" class="xref">SIMPLE-PAGE</a>
See <a href="#GENERIC-FUNCTION%20STAPLE%3AINFER-PROJECT" class="xref">INFER-PROJECT</a></pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION STAPLE:PAGES"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20STAPLE%3APAGES">PAGES</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">PROJECT</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/staple/blob/master/project.lisp#L18">Source</a>  </header> <div class="docstring"><pre>Returns the list of pages that the project generates.

See <a href="#CLASS%20STAPLE%3APAGE" class="xref">PAGE</a>
See <a href="#GENERIC-FUNCTION%20STAPLE%3APROJECT" class="xref">PROJECT</a></pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION STAPLE:(SETF PAGES)"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20STAPLE%3A%28SETF%20PAGES%29">(SETF PAGES)</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">NEW-VALUE</li>    <li class="argument">OBJECT</li>  </ul>  </header> <div class="docstring"><i>No documentation provided.</i></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION STAPLE:PROJECT"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20STAPLE%3APROJECT">PROJECT</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">OBJECT</li>  </ul>  </header> <div class="docstring"><pre>Accessor to the page's project.

See <a href="#CLASS%20STAPLE%3APAGE" class="xref">PAGE</a></pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION STAPLE:(SETF PROJECT)"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20STAPLE%3A%28SETF%20PROJECT%29">(SETF PROJECT)</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">NEW-VALUE</li>    <li class="argument">OBJECT</li>  </ul>  </header> <div class="docstring"><i>No documentation provided.</i></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION STAPLE:RELATIVE-PATH"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20STAPLE%3ARELATIVE-PATH">RELATIVE-PATH</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">TO</li>    <li class="argument">FROM</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/staple/blob/master/toolkit.lisp#L324">Source</a>  </header> <div class="docstring"><pre>Return the relative path from the second argument to the first.

By default the following cases are handled:

  To:      From:         Explanation:
  --------------------------------------------------------------------
  PATHNAME PATHNAME  --- Computes the relative pathname.
      PAGE        T  --- Delegates using OUTPUT.
         T     PAGE  --- Delegates using OUTPUT.
   PROJECT        T  --- Delegates using OUTPUT.
         T  PROJECT  --- Delegates using OUTPUT.
      PAGE  (EQL T)  --- Delegates using PROJECT.

See PATHNAME-UTILS:RELATIVE-PATH
See <a href="#GENERIC-FUNCTION%20STAPLE%3AOUTPUT" class="xref">OUTPUT</a>
See <a href="#GENERIC-FUNCTION%20STAPLE%3APROJECT" class="xref">PROJECT</a>
See <a href="#CLASS%20STAPLE%3APAGE" class="xref">PAGE</a></pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION STAPLE:RESOLVE-SOURCE-LINK"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20STAPLE%3ARESOLVE-SOURCE-LINK">RESOLVE-SOURCE-LINK</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">SOURCE</li>    <li class="argument">PAGE</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/staple/blob/master/page.lisp#L168">Source</a>  </header> <div class="docstring"><pre>Resolve the link to a source file to a URI.

The source should be either a definition or a source spec. In case of
a definition, the function is called again with the source spec as
computed by ABSOLUTE-SOURCE-LOCATION on DEFINITIONS:SOURCE-LOCATION.
A source spec should be a plist of the following possible keys:

  :FILE  --- An absolute pathname to the source file. Required.
  :ROW   --- An optional row/line to which to point within the file.
  :COL   --- An optional col/char to which to point within the line.

By default this will try a &quot;best effort&quot; resolution, meaning
relative links if the file's path is a subpath of the page's output.
Otherwise it will fall back to a &quot;file://&quot; link.

See <a href="https://Shinmera.github.io/definitions/#GENERIC-FUNCTION%20DEFINITIONS%3ASOURCE-LOCATION" class="xref">DEFINITIONS:SOURCE-LOCATION</a>
See <a href="#FUNCTION%20STAPLE%3AABSOLUTE-SOURCE-LOCATION" class="xref">ABSOLUTE-SOURCE-LOCATION</a></pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION STAPLE:SUBSYSTEMS"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20STAPLE%3ASUBSYSTEMS">SUBSYSTEMS</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">SYSTEM</li>  </ul>  </header> <div class="docstring"><pre>Returns a list of systems that are related to the given system.

By default this will find all ASDF systems whose name contains the
given system's name as a prefix.

You may add a method specialising on a particular system to change
which subsystems are used for an inferred project.

See <a href="#GENERIC-FUNCTION%20STAPLE%3AINFER-PROJECT" class="xref">INFER-PROJECT</a></pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION STAPLE:SYSTEM"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20STAPLE%3ASYSTEM">SYSTEM</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">OBJECT</li>  </ul>  </header> <div class="docstring"><pre>Accessor to the system the object is associated with.

See <a href="#CLASS%20STAPLE%3ASYSTEM-PAGE" class="xref">SYSTEM-PAGE</a>
See <a href="#CONDITION%20STAPLE%3ANO-KNOWN-OUTPUT-DIRECTORY" class="xref">NO-KNOWN-OUTPUT-DIRECTORY</a></pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION STAPLE:(SETF SYSTEM)"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20STAPLE%3A%28SETF%20SYSTEM%29">(SETF SYSTEM)</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">NEW-VALUE</li>    <li class="argument">OBJECT</li>  </ul>  </header> <div class="docstring"><i>No documentation provided.</i></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION STAPLE:TEMPLATE"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20STAPLE%3ATEMPLATE">TEMPLATE</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">SYSTEM</li>  </ul>  </header> <div class="docstring"><pre>Returns the pathname to a Clip template suitable for the given system.

You may add a method specialising on a particular system to change
which template is used for an inferred project.

See <a href="#GENERIC-FUNCTION%20STAPLE%3AINFER-PROJECT" class="xref">INFER-PROJECT</a></pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION STAPLE:TEMPLATE-DATA"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20STAPLE%3ATEMPLATE-DATA">TEMPLATE-DATA</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">PAGE</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/staple/blob/master/page.lisp#L106">Source</a>  </header> <div class="docstring"><pre>Returns the arguments to CLIP:PROCESS that should be used for the page.

This should be a plistt containing the necessary data to compile the
template. Note that this generic function uses the APPEND method-
combination, meaning that you may add new keys by simply adding a new
method to this function. The method combination uses
:MOST-SPECIFIC-FIRST, and since plists short-circuit, you may also use
a method to override keys that less-specific methods may have set.

See <a href="#CLASS%20STAPLE%3ATEMPLATED-PAGE" class="xref">TEMPLATED-PAGE</a></pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION STAPLE:TITLE"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20STAPLE%3ATITLE">TITLE</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">OBJECT</li>  </ul>  </header> <div class="docstring"><pre>Accessor to the title of a page.

The title should be a very short, unique identifier for the page
within the project. Pages that represent the same content but in
different languages should have the same titles. The title of a page
may be used as the name for a link to that page.

See <a href="#CLASS%20STAPLE%3APAGE" class="xref">PAGE</a></pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION STAPLE:(SETF TITLE)"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20STAPLE%3A%28SETF%20TITLE%29">(SETF TITLE)</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">NEW-VALUE</li>    <li class="argument">OBJECT</li>  </ul>  </header> <div class="docstring"><i>No documentation provided.</i></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION STAPLE:XREF"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20STAPLE%3AXREF">XREF</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">THING</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/staple/blob/master/xref.lisp#L101">Source</a>  </header> <div class="docstring"><pre>Attempts to find a cross-reference URL for the given thing.

The following default cases are handled:

  DEFINITIONS:DEFINITION --- RESOLVE-XREF is called directly.
  STRING                 --- The string is parsed by PARSE-SYMBOL, and
                             if it represents a valid symbol, matching
                             definitions are attempted to be found via
                             FIND-DEFINITIONS-FOR-IDENTIFIER. The
                             definitions are ranked according to
                             PREFERRED-DEFINITION, and the first one
                             cross-reference via RESOLVE-XREF that can
                             be found is returned.

See <a href="#FUNCTION%20STAPLE%3ARESOLVE-XREF" class="xref">RESOLVE-XREF</a>
See <a href="#FUNCTION%20STAPLE%3APARSE-SYMBOL" class="xref">PARSE-SYMBOL</a>
See <a href="#FUNCTION%20STAPLE%3AFIND-DEFINITIONS-FOR-IDENTIFIER" class="xref">FIND-DEFINITIONS-FOR-IDENTIFIER</a>
See <a href="#FUNCTION%20STAPLE%3APREFERRED-DEFINITION" class="xref">PREFERRED-DEFINITION</a></pre></div> </article> </li>  <li> <article class="definition macro callable" id="MACRO-FUNCTION STAPLE:DEFINE-SOURCE-COMPILER"> <header> <span class="visibility">EXTERNAL</span> <span class="type">MACRO</span> <h4 class="name"> <a href="#MACRO-FUNCTION%20STAPLE%3ADEFINE-SOURCE-COMPILER">DEFINE-SOURCE-COMPILER</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <ul class="arguments"> <li class="argument">TYPE</li>  <li class="argument lambda-list-keyword">&amp;REST</li>  <li class="argument">PATHNAME-TYPES</li> </ul>    <ul class="arguments"> <li class="argument">INPUT</li> </ul>    <li class="argument lambda-list-keyword">&amp;BODY</li>    <li class="argument">BODY</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/staple/blob/master/transform.lisp#L39">Source</a>  </header> <div class="docstring"><pre>Defines a new source compiler variant.

This is a shorthand that sets the PATHNAME-TYPE-&gt;TYPE association and
defines a new method on COMPILE-SOURCE to handle the conversion.
Thus, the TYPE should be a keyword identifying the source type, and
PATHNAME-TYPES should be an enumeration of known file types that are
used for this kind of conversion. You may also leave this empty if you
are defining a source type conversion that is not usually backed by
explicit files.

See <a href="#FUNCTION%20STAPLE%3APATHNAME-TYPE-%3ETYPE" class="xref">PATHNAME-TYPE-&gt;TYPE</a>
See <a href="#GENERIC-FUNCTION%20STAPLE%3ACOMPILE-SOURCE" class="xref">COMPILE-SOURCE</a></pre></div> </article> </li>  <li> <article class="definition macro callable" id="MACRO-FUNCTION STAPLE:DEFINE-XREF-RESOLVER"> <header> <span class="visibility">EXTERNAL</span> <span class="type">MACRO</span> <h4 class="name"> <a href="#MACRO-FUNCTION%20STAPLE%3ADEFINE-XREF-RESOLVER">DEFINE-XREF-RESOLVER</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">NAME</li>    <li class="argument">ARGS</li>    <li class="argument lambda-list-keyword">&amp;BODY</li>    <li class="argument">BODY</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/staple/blob/master/xref.lisp#L21">Source</a>  </header> <div class="docstring"><pre>Defines a new cross-reference resolver function.

The lambda-list should accept one required argument, the definition
instance to find a cross-reference for.
The name can be either a name for the resolver, or a list of name
and priority number.

See <a href="#FUNCTION%20STAPLE%3AXREF-RESOLVER" class="xref">XREF-RESOLVER</a>
See <a href="#FUNCTION%20STAPLE%3AREMOVE-XREF-RESOLVER" class="xref">REMOVE-XREF-RESOLVER</a>
See <a href="#FUNCTION%20STAPLE%3ARESOLVE-XREF" class="xref">RESOLVE-XREF</a></pre></div> </article> </li>  <li> <article class="definition macro callable" id="MACRO-FUNCTION STAPLE:WITH-STREAM"> <header> <span class="visibility">EXTERNAL</span> <span class="type">MACRO</span> <h4 class="name"> <a href="#MACRO-FUNCTION%20STAPLE%3AWITH-STREAM">WITH-STREAM</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <ul class="arguments"> <li class="argument">STREAM</li>  <li class="argument">DESIGNATOR</li>  <li class="argument lambda-list-keyword">&amp;REST</li>  <li class="argument">ARGS</li> </ul>    <li class="argument lambda-list-keyword">&amp;BODY</li>    <li class="argument">BODY</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/staple/blob/master/toolkit.lisp#L286">Source</a>  </header> <div class="docstring"><pre>Handles stream opening and closing, returning a useful value.

Essentially this calls ENSURE-STREAM on the designator and the args.
Upon unwinding, CLOSE is called on the stream. On successful exit of
the body, STREAM-VALUE is returned.

See <a href="#FUNCTION%20STAPLE%3AENSURE-STREAM" class="xref">ENSURE-STREAM</a>
See <a href="#FUNCTION%20STAPLE%3ASTREAM-VALUE" class="xref">STREAM-VALUE</a></pre></div> </article> </li> </ul> </article> </li> </ul> </section> </article> <script>window.addEventListener("DOMContentLoaded", function(){
    var unmarkElement = function(el){
        if(el.tagName === "mark" || el.tagName === "MARK"){
            [].forEach.call(el.childNodes, function(child){
                el.parentNode.insertBefore(child, el);
            });
            el.parentNode.removeChild(el);
        }else if(el.parentNode.tagName === "mark"){
            return unmarkElement(el.parentNode);
        }
        return null;
    }

    var unmarkAll = function(root){
        root = root || document;
        [].forEach.call(root.querySelectorAll("mark"), unmarkElement);
    }
    
    var markElement = function(el){
        if(el.parentNode.tagName === "mark" || el.parentNode.tagName === "MARK"){
            return el.parentNode;
        } else {
            unmarkAll();
            var marked = document.createElement("mark");
            el.parentNode.insertBefore(marked, el);
            marked.appendChild(el);
            return marked;
        }
    }

    var markFragmented = function(){
        if(window.location.hash){
            var el = document.getElementById(decodeURIComponent(window.location.hash.substr(1)));
            if(el) markElement(el);
        }
    }

    var registerXrefLink = function(link){
        var el = document.getElementById(decodeURIComponent(link.getAttribute("href").substr(1)));
        if(el){
            link.addEventListener("click", function(){
                markElement(el);
            });
        }
    }

    var registerXrefLinks = function(root){
        root = root || document;
        [].forEach.call(root.querySelectorAll("a.xref"), registerXrefLink);
    }

    markFragmented();
    registerXrefLinks();
}); </script> </body> </html> 